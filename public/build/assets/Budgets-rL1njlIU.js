import{r as B,l as m,y as V,V as P,b as c,o as d,d as h,u as D,m as z,w as j,a as t,j as _,c as G,f as v,t as a,H as M,n as k,F as y,i as A,k as H}from"./app-Chcy7ag1.js";import{A as U}from"./AuthenticatedLayout-Sxq6dVQ0.js";import{_ as q}from"./Sidebar-CIqoqWWF.js";import{_ as N}from"./BudgetBarChart-Ba7rMvl0.js";import{f as Q}from"./useDateFormat-pjOuPPEs.js";import{_ as R}from"./IncomeExpenseTrendChart-pGKFuIqZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                */import"./UserIcon--kC1NwdM.js";import"./ChartBarIcon-BXoKtaIP.js";import"./useFormatCurrency-DPZVhC5N.js";import"./index-C5rI9DZQ.js";const W={class:"w-full text-gray-900"},X={class:"py-6"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},tt={class:"flex justify-between"},et={class:"text-2xl font-semibold text-gray-900"},st={key:1,class:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3"},ot={class:"bg-white overflow-hidden shadow rounded-lg"},nt={class:"px-4 py-5 sm:p-6"},at={class:"mt-1 text-3xl font-semibold text-green-600"},lt={class:"bg-white overflow-hidden shadow rounded-lg"},rt={class:"px-4 py-5 sm:p-6"},it={class:"mt-1 text-3xl font-semibold text-red-500"},dt={class:"bg-white overflow-hidden shadow rounded-lg"},ct={class:"px-4 py-5 sm:p-6"},ut={class:"my-4 w-[50%] flex flex-col items-center justify-center mx-auto"},mt=["value"],pt={key:2,class:"mt-8 grid grid-cols-1 gap-8 lg:grid-cols-2"},xt={key:3,class:"mt-8"},ht={class:"mt-12"},gt={class:"text-xl font-bold text-gray-900 text-center"},_t={class:"mt-4 bg-white shadow rounded-lg"},vt={class:"divide-y divide-gray-200"},yt={class:"flex items-center justify-between"},ft={class:"text-sm font-medium text-gray-900"},bt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},wt={class:"text-green-600 font-medium"},St={class:"px-4 py-3 bg-gray-50"},Et={class:"flex items-center justify-between"},Mt={class:"text-sm font-bold text-green-600"},At={class:"mt-12"},Tt={class:"text-xl font-bold text-gray-900 text-center"},kt={class:"mt-4 bg-white shadow rounded-lg"},Lt={class:"divide-y divide-gray-200"},It={class:"flex items-center justify-between"},Ot={class:"text-sm font-medium text-gray-900"},Bt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},Dt={class:"text-red-600 font-medium"},jt={class:"px-4 py-3 bg-gray-50"},Nt={class:"flex items-center justify-between"},Ft={class:"text-sm font-bold text-red-600"},Kt={class:"mt-12"},Ct={class:"text-xl font-bold text-center text-gray-900"},Yt={class:"mt-4 bg-white shadow rounded-lg"},Jt={class:"divide-y divide-gray-200"},$t={key:0,class:"px-4 py-6 text-center text-gray-500"},Vt={class:"flex items-center justify-between"},Pt={class:"text-sm font-medium text-gray-900"},zt={class:"text-sm text-gray-500"},Gt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},Ht={class:"px-4 py-3 bg-gray-50 border-t border-gray-200"},Ut={class:"flex justify-between items-center"},qt={class:"text-sm font-medium text-gray-700"},Qt={class:"text-right"},Rt={class:"text-sm font-medium text-green-600"},Wt={class:"text-sm font-medium text-red-600"},ce={__name:"Budgets",props:{data:Object,today:String},setup(F){const r=F,u=B(null),f=B([]),b=m(()=>u.value?(r.data.transactions||[]).filter(o=>{const e=new Date(o.transaction_date);return L(e)===u.value}):[]),T=m(()=>b.value.filter(o=>o.type==="income")),g=m(()=>b.value.filter(o=>o.type!=="income")),w=m(()=>T.value.reduce((o,e)=>o+parseFloat(e.amount),0)),S=m(()=>g.value.reduce((o,e)=>o+parseFloat(e.amount),0)),E=m(()=>w.value-S.value),K=m(()=>{const l=T.value.reduce((s,n)=>{const i=n.category;return s[i]||(s[i]={totalAmount:0,incomes:[]}),s[i].totalAmount+=parseFloat(n.amount),s[i].incomes.push(n),s},{});return Object.entries(l).map(([s,{totalAmount:n}])=>({label:s,amount:Math.round(n)})).sort((s,n)=>n.amount-s.amount).slice(0,3)}),C=m(()=>{const l=g.value.reduce((n,i)=>{const x=i.category;return n[x]||(n[x]=[]),n[x].push(i),n},{});return Object.entries(l).map(([n,i])=>({category:n,totalAmount:i.reduce((x,$)=>x+parseFloat($.amount),0),expenses:i})).sort((n,i)=>i.totalAmount-n.totalAmount).slice(0,3).map(n=>({label:n.category,amount:Math.round(n.totalAmount),expenses:n.expenses}))}),Y=m(()=>!g.value||g.value.length===0?{}:g.value.reduce((o,e)=>{const l=e.category;return o[l]||(o[l]=0),o[l]+=parseFloat(e.amount),o},{})),p=m(()=>r.data&&(r.data.incomes&&r.data.incomes.length||r.data.expenses&&r.data.expenses.length||r.data.goals&&r.data.goals.length||r.data.debts&&r.data.debts.length||r.data.investments&&r.data.investments.length));V(()=>{J()});function J(){const o={};(r.data.transactions||[]).forEach(e=>{if(e.transaction_date){const l=new Date(e.transaction_date);if(isNaN(l.getTime()))console.warn("Invalid transaction_date:",e.transaction_date);else{const s=L(l);o[s]=!0}}}),f.value=Object.keys(o).sort((e,l)=>{const[s,n]=e.split(" "),[i,x]=l.split(" ");return parseInt(x)-parseInt(n)||I(i)-I(s)}),f.value.length>0&&O(f.value[0])}function L(o){return`${["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]} ${o.getFullYear()}`}function I(o){return["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(o.split(" ")[0])}function O(o){u.value=o}return(o,e)=>{const l=P("Alert");return d(),c(y,null,[h(D(z),{title:"Budgets"}),h(U,null,{default:j(()=>[t("div",W,[h(q,null,{default:j(()=>[t("div",X,[t("div",Z,[_(t("div",tt,[t("div",null,[t("h1",et,a(u.value)+"'s Budget",1)])],512),[[M,p.value]]),o.alertState?(d(),G(l,{key:0,type:o.alertState.type,message:o.alertState.message,duration:o.alertState.duration,"auto-close":o.alertState.autoClose,onClose:o.clearAlert},null,8,["type","message","duration","auto-close","onClose"])):v("",!0),p.value?(d(),c("div",st,[t("div",ot,[t("div",nt,[e[2]||(e[2]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Income",-1)),t("dd",at,"KES "+a(w.value.toLocaleString()),1)])]),t("div",lt,[t("div",rt,[e[3]||(e[3]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Expenses",-1)),t("dd",it,"KES "+a(S.value.toLocaleString()),1)])]),t("div",dt,[t("div",ct,[e[4]||(e[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Balance",-1)),t("dd",{class:k(["mt-1 text-3xl font-semibold",E.value>=0?"text-green-600":"text-red-600"])}," KES "+a(E.value.toLocaleString()),3)])])])):v("",!0),t("div",ut,[e[5]||(e[5]=t("label",{for:"monthSelect",class:"block text-sm font-medium text-gray-700 mb-1"},"Select Month",-1)),_(t("select",{id:"monthSelect","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),onChange:e[1]||(e[1]=s=>O(u.value)),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[(d(!0),c(y,null,A(f.value,(s,n)=>(d(),c("option",{key:n,value:s},a(s),9,mt))),128))],544),[[H,u.value]])]),p.value?(d(),c("div",pt,[h(N,{title:"Top Income Sources",items:K.value,type:"income",class:"bg-white shadow rounded-lg"},null,8,["items"]),h(N,{title:"Top Expenses",items:C.value,type:"expense",class:"bg-white shadow rounded-lg"},null,8,["items"])])):v("",!0),p.value?(d(),c("div",xt,[h(R,{transactions:r.data.transactions},null,8,["transactions"])])):v("",!0),_(t("div",ht,[t("h2",gt,"Your Income - "+a(u.value),1),t("div",_t,[t("ul",vt,[(d(!0),c(y,null,A(T.value,s=>(d(),c("li",{key:s.id,class:"px-4 py-3"},[t("div",yt,[t("div",null,[t("p",ft,a(s.category)+" - "+a(s.description),1)]),t("div",bt,[t("div",wt," + KES "+a(Math.round(parseFloat(s.amount)).toLocaleString()),1)])])]))),128)),t("li",St,[t("div",Et,[e[6]||(e[6]=t("div",null,[t("p",{class:"text-sm font-bold text-gray-900"}," TOTAL INCOME ")],-1)),t("div",Mt," KES "+a(w.value.toLocaleString()),1)])])])])],512),[[M,p.value]]),_(t("div",At,[t("h2",Tt,"Your Budget - "+a(u.value),1),t("div",kt,[t("ul",Lt,[(d(!0),c(y,null,A(Y.value,(s,n)=>(d(),c("li",{key:n,class:"px-4 py-3"},[t("div",It,[t("div",null,[t("p",Ot,a(n),1)]),t("div",Bt,[t("div",Dt," - KES "+a(Math.round(parseFloat(s)).toLocaleString()),1)])])]))),128)),t("li",jt,[t("div",Nt,[e[7]||(e[7]=t("div",null,[t("p",{class:"text-sm font-bold text-gray-900"}," TOTAL MONTHLY BUDGET ")],-1)),t("div",Ft," KES "+a(S.value.toLocaleString()),1)])])])])],512),[[M,p.value]]),_(t("div",Kt,[t("h2",Ct,"All Transactions - "+a(u.value),1),t("div",Yt,[t("ul",Jt,[b.value.length===0?(d(),c("li",$t," No transactions right now. Add the first transaction. ")):v("",!0),(d(!0),c(y,null,A(b.value,s=>(d(),c("li",{key:s.id,class:"px-4 py-3"},[t("div",Vt,[t("div",null,[t("p",Pt,a(s.description),1),t("p",zt,a(D(Q)(s.transaction_date)),1)]),t("div",Gt,[t("div",{class:k([s.type==="income"?"text-green-600":"text-red-600","font-medium"])},a(s.type==="income"?"+":"-")+" KES "+a(Math.round(s.amount).toLocaleString()),3)])])]))),128))]),t("div",Ht,[t("div",Ut,[t("span",qt,a(u.value)+" Summary:",1),t("div",Qt,[t("p",Rt,"Income: KES "+a(w.value.toLocaleString()),1),t("p",Wt,"Expenses: KES "+a(S.value.toLocaleString()),1),t("p",{class:k(["text-sm font-bold",E.value>=0?"text-green-600":"text-red-600"])}," Balance: KES "+a(E.value.toLocaleString()),3)])])])])],512),[[M,p.value]])])])]),_:1})])]),_:1})],64)}}};export{ce as default};
