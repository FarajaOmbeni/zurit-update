import{r as C,C as H,b as u,o as a,d as l,u as s,m as Q,w as k,a as t,f as p,c as W,n as X,t as i,h as m,g as Z,F,i as ee,P as U}from"./app-DsD-n4JU.js";import{A as te}from"./AuthenticatedLayout-xVb4ke35.js";import{_ as se}from"./Sidebar-B8XwlamX.js";import{_ as oe}from"./DashboardBackButton-CrHd89q8.js";import{_ as re,r as j,a as ne,b as I}from"./LegacyProgress-7ZZYZqvP.js";import{_ as b}from"./Input-Dx-lqL61.js";import{_ as le}from"./Select-BrzKX9hX.js";import{_ as ae}from"./Alert-uwl6MtLU.js";import{u as ie}from"./useAlert-F0U4ts5N.js";import{r as B}from"./BanknotesIcon-CkNk0TS4.js";import{r as ue}from"./CalendarIcon-6aWZzBAR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                */import"./EllipsisHorizontalIcon-CeLqe4vC.js";import"./AcademicCapIcon-337SsQ9X.js";import"./UserIcon-CimjXTqK.js";import"./ChartBarIcon-DTGHqwaO.js";import"./HomeIcon-DRwSzbYE.js";const de={class:"w-full text-gray-900"},ce={class:"max-w-6xl mx-auto p-6"},me={class:"flex justify-between items-center mb-8"},pe={class:"text-right"},ge={class:"mb-6"},fe={key:1,class:"bg-white rounded-lg shadow-sm border p-6 mb-8"},ye={class:"text-lg font-semibold text-gray-900 mb-4"},ve={class:"grid md:grid-cols-2 gap-4"},be={class:"grid md:grid-cols-2 gap-4"},_e={class:"grid md:grid-cols-2 gap-4"},xe={class:"flex space-x-4"},he=["disabled"],we={key:2,class:"space-y-4 mb-8"},Ce={class:"grid gap-4"},ke={class:"flex items-start justify-between"},Ve={class:"flex-1"},Pe={class:"text-lg font-semibold text-gray-900"},Se={class:"text-sm text-gray-500"},De={class:"text-sm text-gray-600 mt-1 space-y-1"},$e={key:0},Ae={class:"flex items-center space-x-4"},Ee={key:0,class:"flex items-center space-x-1"},Ne={key:1,class:"flex items-center space-x-1"},Fe={key:2,class:"flex items-center space-x-1"},Ue={key:1},je={class:"flex items-center space-x-2 ml-4"},Ie=["onClick"],Be=["onClick"],Le={key:3,class:"text-center py-12"},Te={class:"flex items-center justify-between pt-8 border-t"},Ke={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Me={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},Oe={class:"p-6"},Re={class:"flex items-center mb-4"},Ye={class:"flex-shrink-0"},qe={class:"mb-6"},ze={class:"text-gray-600"},Je={class:"flex space-x-4"},Ge=["disabled"],pt={__name:"Insurance",props:{insurances:{type:Array,default:()=>[]}},setup(L){const x=L,{openAlert:g,clearAlert:T,alertState:_}=ie(),c=C(!1),h=C(!1),d=C(null),f=C(null),K=[{value:"insurance",label:"Insurance"},{value:"pension",label:"Pension"}],o=H({type:"insurance",provider_name:"",policy_number:"",coverage_amount:"",premium_amount:"",renewal_date:"",notes:""});function V(r){return r==null||r===""?"—":new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0,maximumFractionDigits:0}).format(Number(r))}function M(r){if(!r)return"Not specified";if(/^\d{4}-\d{2}-\d{2}$/.test(r)){const[e,y,v]=r.split("-").map(Number);return new Date(e,y-1,v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}return new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function O(r){if(!r)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(r))return r;const e=new Date(r),y=e.getFullYear(),v=String(e.getMonth()+1).padStart(2,"0"),w=String(e.getDate()).padStart(2,"0");return`${y}-${v}-${w}`}function P(){d.value=null,o.reset(),o.type="insurance",c.value=!0}function R(r){d.value=r,o.type=r.type||"insurance",o.provider_name=r.provider_name||"",o.policy_number=r.policy_number||"",o.coverage_amount=r.coverage_amount??"",o.premium_amount=r.premium_amount??"",o.renewal_date=r.renewal_date?O(r.renewal_date):"",o.notes=r.notes||"",c.value=!0}function S(){d.value=null,o.reset(),c.value=!1}function Y(){d.value?o.put(route("legacy.insurance.update",d.value.id),{preserveScroll:!0,onSuccess:()=>{o.reset(),c.value=!1,d.value=null,g("success","Insurance updated successfully!",5e3)},onError:r=>{const e=Object.values(r||{}).flat().join(" ");g("danger",e||"Could not update insurance.",1e4)}}):o.post(route("legacy.insurance.store"),{preserveScroll:!0,onSuccess:()=>{o.reset(),c.value=!1,g("success","Insurance added successfully!",5e3)},onError:r=>{const e=Object.values(r||{}).flat().join(" ");g("danger",e||"Could not add insurance.",1e4)}})}function q(r){f.value=r,h.value=!0}function z(){f.value&&o.delete(route("legacy.insurance.destroy",f.value.id),{preserveScroll:!0,onSuccess:()=>{h.value=!1,f.value=null,g("success","Insurance deleted successfully!",5e3)},onError:r=>{const e=Object.values(r||{}).flat().join(" ");g("danger",e||"Could not delete insurance.",1e4)}})}function J(){h.value=!1,f.value=null}return(r,e)=>(a(),u(F,null,[l(s(Q),{title:"Insurance - Legacy & Estate Planning"}),l(te,null,{default:k(()=>{var y;return[t("div",de,[l(se,null,{default:k(()=>{var v,w,D,$,A,E,N;return[l(oe),t("div",ce,[s(_)?(a(),W(ae,{key:0,type:s(_).type,message:s(_).message,duration:s(_).duration,"auto-close":s(_).autoClose,onClose:s(T)},null,8,["type","message","duration","auto-close","onClose"])):p("",!0),t("div",me,[e[10]||(e[10]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Step 4: Insurance & Pensions "),t("p",{class:"text-gray-600"}," Add your insurance or pension policies so they’re considered in your plan. ")],-1)),t("div",pe,[e[9]||(e[9]=t("div",{class:"text-sm text-gray-500 mb-1"},"Total Policies",-1)),t("div",{class:X(["text-2xl font-bold",x.insurances.length?"text-purple-600":"text-gray-400"])},i(x.insurances.length),3)])]),l(re,{current:4}),t("div",ge,[t("button",{onClick:e[0]||(e[0]=n=>c.value?d.value?S():c.value=!1:P()),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[l(s(j),{class:"w-5 h-5 mr-2"}),m(" "+i(c.value?"Cancel":"Add Policy"),1)])]),c.value?(a(),u("div",fe,[t("h3",ye,i(d.value?"Edit Policy":"Add New Policy"),1),t("form",{onSubmit:Z(Y,["prevent"]),class:"space-y-4"},[t("div",ve,[l(le,{modelValue:s(o).type,"onUpdate:modelValue":e[1]||(e[1]=n=>s(o).type=n),label:"Type",options:K,error:(v=s(o).errors)==null?void 0:v.type,required:""},null,8,["modelValue","error"]),l(b,{modelValue:s(o).provider_name,"onUpdate:modelValue":e[2]||(e[2]=n=>s(o).provider_name=n),label:"Provider",placeholder:"e.g., Jubilee Insurance",error:(w=s(o).errors)==null?void 0:w.provider_name,required:""},null,8,["modelValue","error"])]),t("div",be,[l(b,{modelValue:s(o).policy_number,"onUpdate:modelValue":e[3]||(e[3]=n=>s(o).policy_number=n),label:"Policy Number",placeholder:"e.g., ABC-12345",error:(D=s(o).errors)==null?void 0:D.policy_number},null,8,["modelValue","error"]),l(b,{modelValue:s(o).renewal_date,"onUpdate:modelValue":e[4]||(e[4]=n=>s(o).renewal_date=n),type:"date",label:"Renewal Date (optional)",error:($=s(o).errors)==null?void 0:$.renewal_date},null,8,["modelValue","error"])]),t("div",_e,[l(b,{modelValue:s(o).coverage_amount,"onUpdate:modelValue":e[5]||(e[5]=n=>s(o).coverage_amount=n),type:"number",step:"0.01",min:"0",label:"Coverage Amount (KES)",placeholder:"0.00",error:(A=s(o).errors)==null?void 0:A.coverage_amount},null,8,["modelValue","error"]),l(b,{modelValue:s(o).premium_amount,"onUpdate:modelValue":e[6]||(e[6]=n=>s(o).premium_amount=n),type:"number",step:"0.01",min:"0",label:"Premium (KES)",placeholder:"0.00",error:(E=s(o).errors)==null?void 0:E.premium_amount},null,8,["modelValue","error"])]),l(b,{modelValue:s(o).notes,"onUpdate:modelValue":e[7]||(e[7]=n=>s(o).notes=n),label:"Notes (optional)",placeholder:"Any extra details",error:(N=s(o).errors)==null?void 0:N.notes},null,8,["modelValue","error"]),t("div",xe,[t("button",{type:"submit",disabled:s(o).processing,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},i(s(o).processing?d.value?"Updating...":"Adding...":d.value?"Update Policy":"Add Policy"),9,he),t("button",{type:"button",onClick:e[8]||(e[8]=n=>d.value?S():c.value=!1),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"}," Cancel ")])],32)])):p("",!0),x.insurances.length?(a(),u("div",we,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Your Policies",-1)),t("div",Ce,[(a(!0),u(F,null,ee(x.insurances,n=>(a(),u("div",{key:n.id,class:"bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow"},[t("div",ke,[t("div",Ve,[t("h4",Pe,[m(i(n.provider_name)+" ",1),t("span",Se,"("+i(n.type)+")",1)]),t("div",De,[n.policy_number?(a(),u("div",$e,[e[11]||(e[11]=t("span",{class:"font-medium"},"Policy #:",-1)),m(" "+i(n.policy_number),1)])):p("",!0),t("div",Ae,[n.coverage_amount?(a(),u("div",Ee,[l(s(B),{class:"w-4 h-4"}),t("span",null,"Coverage: "+i(V(n.coverage_amount)),1)])):p("",!0),n.premium_amount?(a(),u("div",Ne,[l(s(B),{class:"w-4 h-4"}),t("span",null,"Premium: "+i(V(n.premium_amount)),1)])):p("",!0),n.renewal_date?(a(),u("div",Fe,[l(s(ue),{class:"w-4 h-4"}),t("span",null,"Renews: "+i(M(n.renewal_date)),1)])):p("",!0)]),n.notes?(a(),u("div",Ue,[e[12]||(e[12]=t("span",{class:"font-medium"},"Notes:",-1)),m(" "+i(n.notes),1)])):p("",!0)])]),t("div",je,[t("button",{onClick:G=>R(n),class:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",title:"Edit"},[l(s(ne),{class:"w-5 h-5"})],8,Ie),t("button",{onClick:G=>q(n),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete"},[l(s(I),{class:"w-5 h-5"})],8,Be)])])]))),128))])])):(a(),u("div",Le,[e[15]||(e[15]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No policies added yet",-1)),e[16]||(e[16]=t("p",{class:"text-gray-600 mb-6"},"Add your first insurance or pension policy.",-1)),t("button",{onClick:P,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[l(s(j),{class:"w-5 h-5 mr-2"}),e[14]||(e[14]=m(" Add Your First Policy "))])])),t("div",Te,[l(s(U),{href:r.route("legacy.fiduciaries"),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"},{default:k(()=>e[17]||(e[17]=[m(" ← Back to Fiduciaries ")])),_:1},8,["href"]),l(s(U),{href:r.route("legacy.review"),class:"bg-purple-50 hover:bg-purple-100 text-purple-700 font-semibold py-2 px-4 rounded-lg transition-colors duration-200"},{default:k(()=>e[18]||(e[18]=[m(" Continue to Review → ")])),_:1},8,["href"])])])]}),_:1})]),h.value?(a(),u("div",Ke,[t("div",Me,[t("div",Oe,[t("div",Re,[t("div",Ye,[l(s(I),{class:"w-6 h-6 text-red-600"})]),e[19]||(e[19]=t("div",{class:"ml-3"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Delete Policy")],-1))]),t("div",qe,[t("p",ze,[e[20]||(e[20]=m(" Are you sure you want to delete ")),t("strong",null,i((y=f.value)==null?void 0:y.provider_name),1),e[21]||(e[21]=m("? This action cannot be undone. "))])]),t("div",Je,[t("button",{onClick:z,disabled:s(o).processing,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"},i(s(o).processing?"Deleting...":"Delete"),9,Ge),t("button",{onClick:J,class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"}," Cancel ")])])])])):p("",!0)]}),_:1})],64))}};export{pt as default};
