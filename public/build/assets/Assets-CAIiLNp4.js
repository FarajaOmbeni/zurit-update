import{r as b,k as N,C as B,b as u,o as c,d as i,f as y,u as o,m as ie,w as F,a as e,c as re,t as r,h as x,g as de,F as S,i as T,P as ce,n as ue}from"./app-DsD-n4JU.js";import{A as me}from"./AuthenticatedLayout-xVb4ke35.js";import{_ as pe}from"./Sidebar-B8XwlamX.js";import{_ as fe}from"./DashboardBackButton-CrHd89q8.js";import{_ as ve,r as O,a as ge,b as L}from"./LegacyProgress-7ZZYZqvP.js";import{_ as k}from"./Input-Dx-lqL61.js";import{_ as R}from"./Select-BrzKX9hX.js";import{_ as be}from"./Alert-uwl6MtLU.js";import{u as ye}from"./useAlert-F0U4ts5N.js";import{r as z}from"./BuildingOfficeIcon-B79X9DrP.js";import{r as xe}from"./BanknotesIcon-CkNk0TS4.js";import{r as _e}from"./CalendarIcon-6aWZzBAR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                */import"./EllipsisHorizontalIcon-CeLqe4vC.js";import"./AcademicCapIcon-337SsQ9X.js";import"./UserIcon-CimjXTqK.js";import"./ChartBarIcon-DTGHqwaO.js";import"./HomeIcon-DRwSzbYE.js";const he={class:"w-full text-gray-900"},we={class:"max-w-6xl mx-auto p-6"},Ae={class:"flex justify-between items-center mb-8"},ke={class:"text-right"},Ce={class:"text-2xl font-bold text-green-600"},Ve={class:"text-sm text-gray-500 mt-1"},$e={class:"mb-6"},je={key:1,class:"bg-white rounded-lg shadow-sm border p-6 mb-8"},De={class:"text-lg font-semibold text-gray-900 mb-4"},Se={class:"grid md:grid-cols-2 gap-4"},Ee={class:"grid md:grid-cols-2 gap-4"},Fe={class:"flex space-x-4"},Te=["disabled"],qe={key:2,class:"space-y-4 mb-8"},Ue={class:"grid gap-4"},Me={class:"flex items-start justify-between"},Ne={class:"flex-1"},Be={class:"flex items-center space-x-3 mb-2"},Oe={class:"text-lg font-semibold text-gray-900"},Le={class:"text-sm text-gray-500"},Re={key:0,class:"text-gray-600 mb-3"},ze={class:"flex items-center space-x-6 text-sm text-gray-500"},Pe={class:"flex items-center space-x-1"},Ye={class:"flex items-center space-x-1"},Ie={class:"mt-4"},Ke={class:"flex items-center justify-between mb-2"},He={class:"text-sm text-gray-600"},Je=["onClick"],Ge={key:0,class:"space-y-1"},Qe={class:"text-gray-700"},We={class:"text-gray-900 font-medium"},Xe={class:"text-xs text-gray-500 mt-1"},Ze={class:"flex items-center space-x-2 ml-4"},et=["onClick"],tt=["onClick"],st={key:3,class:"text-center py-12"},lt={key:4,class:"flex justify-end pt-8 border-t"},ot={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},at={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},nt={class:"p-6"},it={class:"flex items-center mb-4"},rt={class:"flex-shrink-0"},dt={class:"mb-6"},ct={class:"text-gray-600"},ut={class:"flex space-x-4"},mt=["disabled"],pt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ft={class:"bg-white rounded-lg shadow-xl max-w-xl w-full mx-4"},vt={class:"p-6"},gt={class:"mb-4"},bt={class:"text-gray-600 text-sm"},yt={class:"flex items-center justify-between mb-3"},xt={class:"text-sm text-gray-600"},_t={key:0,class:"text-gray-600 text-sm mb-4"},ht={class:"space-y-3 max-h-80 overflow-y-auto mb-4"},wt={class:"md:col-span-4"},At={class:"md:col-span-2"},kt={class:"md:col-span-6 flex justify-end"},Ct=["onClick"],Vt={class:"flex space-x-4"},$t=["disabled"],Ht={__name:"Assets",props:{assets:{type:Array,default:()=>[]},beneficiaries:{type:Array,default:()=>[]}},setup(w){const E=w,{openAlert:v,clearAlert:P,alertState:A}=ye(),p=b(!1),C=b(!1),f=b(null),_=b(null),V=b(!1),$=b(!1),j=b(null),g=b([]),Y=N(()=>E.beneficiaries.map(s=>({value:s.id,label:s.full_name}))),D=N(()=>g.value.reduce((s,t)=>s+(parseFloat(t.percentage)||0),0)),a=B({name:"",type:"",description:"",value:"",acquisition_date:""}),q=[{value:"real_estate",label:"Real Estate"},{value:"vehicle",label:"Vehicle"},{value:"bank_account",label:"Bank Account"},{value:"investment",label:"Investment"},{value:"business",label:"Business"},{value:"jewelry",label:"Jewelry"},{value:"artwork",label:"Artwork"},{value:"electronics",label:"Electronics"},{value:"furniture",label:"Furniture"},{value:"other",label:"Other"}];function I(){f.value?a.put(route("legacy.assets.update",f.value.id),{onSuccess:()=>{a.reset(),p.value=!1,f.value=null,v("success","Asset updated successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}}):a.post(route("legacy.assets.store"),{onSuccess:()=>{a.reset(),p.value=!1,v("success","Asset added successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}})}function U(s){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(s)}function K(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not specified"}function H(s){if(!s)return"";const t=new Date(s),n=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${n}-${d}-${l}`}function J(s){const t=q.find(n=>n.value===s);return t?t.label:s}function G(){return E.assets.reduce((s,t)=>s+parseFloat(t.value||0),0)}function h(s){return(s.beneficiary_allocations||s.beneficiaryAllocations||[]).map(n=>{var d,l;return{id:n.id,beneficiary_id:n.beneficiary_id||((d=n.beneficiary)==null?void 0:d.id),beneficiary_name:(l=n.beneficiary)==null?void 0:l.full_name,percentage:n.percentage}}).filter(n=>n.beneficiary_id)}function Q(){return E.assets.filter(s=>h(s).length>0).length}function W(s){f.value=s,a.name=s.name,a.type=s.type,a.description=s.description||"",a.value=s.value,a.acquisition_date=s.acquisition_date?H(s.acquisition_date):"",p.value=!0}function M(){f.value=null,a.reset(),p.value=!1}function X(s){_.value=s,C.value=!0}function Z(){_.value&&a.delete(route("legacy.assets.destroy",_.value.id),{onSuccess:()=>{C.value=!1,_.value=null,v("success","Asset deleted successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}})}function ee(){C.value=!1,_.value=null}async function te(s){j.value=s,g.value=h(s).map(t=>({beneficiary_id:t.beneficiary_id,percentage:t.percentage})),V.value=!0,$.value=!0;try{const t=route("legacy.asset-allocation.status")+`?asset_id=${s.id}`,n=await fetch(t,{headers:{Accept:"application/json"}});if(n.ok){const d=await n.json();g.value=(d.allocations||[]).map(l=>({beneficiary_id:l.beneficiary_id,percentage:l.percentage}))}}catch{}finally{$.value=!1}}function se(){g.value.push({beneficiary_id:null,percentage:0})}function le(s){g.value.splice(s,1)}function oe(){const s=g.value.map(n=>n.beneficiary_id).filter(Boolean),t=new Set(s);return s.length!==t.size?(v("danger","Each beneficiary can only be allocated once per asset.",8e3),!1):D.value>100.01?(v("danger",`Total allocation cannot exceed 100%. Current: ${D.value}%`,8e3),!1):(g.value=g.value.filter(n=>n.beneficiary_id!=null),!0)}function ae(){if(!j.value||!oe())return;const s={asset_id:j.value.id,beneficiary_allocations:g.value.map(n=>({beneficiary_id:n.beneficiary_id,percentage:Number(n.percentage)||0}))};B(s).post(route("legacy.asset-allocation.store"),{preserveScroll:!0,onSuccess:()=>{V.value=!1,v("success","Allocations saved successfully!",5e3)},onError:n=>{const d=Object.values(n).flat().join(" ");v("danger",d||"Could not save allocations.",1e4)}})}return(s,t)=>{var n;return c(),u(S,null,[i(o(ie),{title:"Assets - Legacy & Estate Planning"}),i(me,null,{default:F(()=>{var d;return[e("div",he,[i(pe,null,{default:F(()=>[i(fe),e("div",we,[o(A)?(c(),re(be,{key:0,type:o(A).type,message:o(A).message,duration:o(A).duration,"auto-close":o(A).autoClose,onClose:o(P)},null,8,["type","message","duration","auto-close","onClose"])):y("",!0),e("div",Ae,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Step 1: Your Assets "),e("p",{class:"text-gray-600"}," Document all your assets that will be part of your estate plan. ")],-1)),e("div",ke,[t[9]||(t[9]=e("div",{class:"text-sm text-gray-500 mb-1"},"Total Asset Value",-1)),e("div",Ce,r(U(G())),1),e("div",Ve,r(Q())+"/"+r(w.assets.length)+" assets allocated ",1)])]),i(ve,{current:1}),e("div",$e,[e("button",{onClick:t[0]||(t[0]=l=>p.value?f.value?M():p.value=!1:p.value=!0),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[i(o(O),{class:"w-5 h-5 mr-2"}),x(" "+r(p.value?"Cancel":"Add Asset"),1)])]),p.value?(c(),u("div",je,[e("h3",De,r(f.value?"Edit Asset":"Add New Asset"),1),e("form",{onSubmit:de(I,["prevent"]),class:"space-y-4"},[e("div",Se,[i(k,{modelValue:o(a).name,"onUpdate:modelValue":t[1]||(t[1]=l=>o(a).name=l),label:"Asset Name",placeholder:"e.g., Family Home, Toyota Camry",error:o(a).errors.name,required:""},null,8,["modelValue","error"]),i(R,{modelValue:o(a).type,"onUpdate:modelValue":t[2]||(t[2]=l=>o(a).type=l),label:"Asset Type",options:q,error:o(a).errors.type,required:""},null,8,["modelValue","error"])]),e("div",Ee,[i(k,{modelValue:o(a).value,"onUpdate:modelValue":t[3]||(t[3]=l=>o(a).value=l),type:"number",step:"0.01",min:"0",label:"Estimated Value (KES)",placeholder:"0.00",error:o(a).errors.value,required:""},null,8,["modelValue","error"]),i(k,{modelValue:o(a).acquisition_date,"onUpdate:modelValue":t[4]||(t[4]=l=>o(a).acquisition_date=l),type:"date",label:"Acquisition Date (Optional)",error:o(a).errors.acquisition_date},null,8,["modelValue","error"])]),i(k,{modelValue:o(a).description,"onUpdate:modelValue":t[5]||(t[5]=l=>o(a).description=l),label:"Description (Optional)",placeholder:"Additional details about the asset",error:o(a).errors.description},null,8,["modelValue","error"]),e("div",Fe,[e("button",{type:"submit",disabled:o(a).processing,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},r(o(a).processing?f.value?"Updating...":"Adding...":f.value?"Update Asset":"Add Asset"),9,Te),e("button",{type:"button",onClick:t[6]||(t[6]=l=>f.value?M():p.value=!1),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])],32)])):y("",!0),w.assets.length>0?(c(),u("div",qe,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Your Assets",-1)),e("div",Ue,[(c(!0),u(S,null,T(w.assets,l=>(c(),u("div",{key:l.id,class:"bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow"},[e("div",Me,[e("div",Ne,[e("div",Be,[i(o(z),{class:"w-6 h-6 text-blue-600 flex-shrink-0"}),e("div",null,[e("h4",Oe,r(l.name),1),e("p",Le,r(J(l.type)),1)])]),l.description?(c(),u("div",Re,r(l.description),1)):y("",!0),e("div",ze,[e("div",Pe,[i(o(xe),{class:"w-4 h-4"}),e("span",null,r(U(l.value)),1)]),e("div",Ye,[i(o(_e),{class:"w-4 h-4"}),e("span",null,r(K(l.acquisition_date)),1)])]),e("div",Ie,[e("div",Ke,[e("div",He,[t[11]||(t[11]=e("span",{class:"font-medium"},"Allocations:",-1)),e("span",null,r(h(l).length>0?"":"None yet"),1)]),e("button",{onClick:m=>te(l),type:"button",class:"text-purple-700 hover:text-purple-800 text-sm font-medium"}," Manage Allocations ",8,Je)]),h(l).length>0?(c(),u("div",Ge,[(c(!0),u(S,null,T(h(l),m=>(c(),u("div",{key:m.beneficiary_id,class:"flex items-center justify-between text-sm"},[e("span",Qe,r(m.beneficiary_name),1),e("span",We,r(m.percentage)+"%",1)]))),128)),e("div",Xe," Total: "+r(h(l).reduce((m,ne)=>m+(parseFloat(ne.percentage)||0),0))+"% ",1)])):y("",!0)])]),e("div",Ze,[e("button",{onClick:m=>W(l),class:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",title:"Edit Asset"},[i(o(ge),{class:"w-5 h-5"})],8,et),e("button",{onClick:m=>X(l),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete Asset"},[i(o(L),{class:"w-5 h-5"})],8,tt)])])]))),128))])])):(c(),u("div",st,[i(o(z),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No assets added yet",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-6"}," Start by adding your first asset to begin your estate plan. ",-1)),e("button",{onClick:t[7]||(t[7]=l=>{f.value=null,p.value=!0}),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[i(o(O),{class:"w-5 h-5 mr-2"}),t[13]||(t[13]=x(" Add Your First Asset "))])])),w.assets.length>0?(c(),u("div",lt,[i(o(ce),{href:s.route("legacy.beneficiaries"),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},{default:F(()=>t[16]||(t[16]=[x(" Continue to Beneficiaries → ")])),_:1},8,["href"])])):y("",!0)])]),_:1})]),C.value?(c(),u("div",ot,[e("div",at,[e("div",nt,[e("div",it,[e("div",rt,[i(o(L),{class:"w-6 h-6 text-red-600"})]),t[17]||(t[17]=e("div",{class:"ml-3"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Delete Asset ")],-1))]),e("div",dt,[e("p",ct,[t[18]||(t[18]=x(" Are you sure you want to delete ")),e("strong",null,r((d=_.value)==null?void 0:d.name),1),t[19]||(t[19]=x("? This action cannot be undone. "))])]),e("div",ut,[e("button",{onClick:Z,disabled:o(a).processing,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},r(o(a).processing?"Deleting...":"Delete"),9,mt),e("button",{onClick:ee,class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])])])])):y("",!0)]}),_:1}),V.value?(c(),u("div",pt,[e("div",ft,[e("div",vt,[e("div",gt,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Manage Allocations",-1)),e("p",bt,[t[20]||(t[20]=x("Asset: ")),e("strong",null,r((n=j.value)==null?void 0:n.name),1)])]),e("div",yt,[e("div",xt,[t[22]||(t[22]=x(" Total: ")),e("strong",{class:ue(D.value>100?"text-red-600":"text-gray-900")},r(D.value)+"%",3),t[23]||(t[23]=e("span",{class:"ml-2"},"(Partial allocations allowed. Do not exceed 100%.)",-1))]),e("button",{onClick:se,type:"button",class:"bg-purple-50 hover:bg-purple-100 text-purple-700 font-semibold py-2 px-3 rounded-lg transition-colors duration-200"}," + Add Row ")]),$.value?(c(),u("div",_t,"Loading current allocations...")):y("",!0),e("div",ht,[(c(!0),u(S,null,T(g.value,(d,l)=>(c(),u("div",{key:l,class:"grid md:grid-cols-6 gap-2 items-end"},[e("div",wt,[i(R,{modelValue:d.beneficiary_id,"onUpdate:modelValue":m=>d.beneficiary_id=m,label:"Beneficiary",options:Y.value,error:""},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",At,[i(k,{modelValue:d.percentage,"onUpdate:modelValue":m=>d.percentage=m,type:"number",step:"0.01",min:"0",max:"100",label:"%"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",kt,[e("button",{onClick:m=>le(l),type:"button",class:"text-red-600 hover:text-red-700 text-sm"},"Remove",8,Ct)])]))),128))]),e("div",Vt,[e("button",{onClick:ae,disabled:$.value,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Save Allocations ",8,$t),e("button",{onClick:t[8]||(t[8]=d=>V.value=!1),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])])])])):y("",!0)],64)}}};export{Ht as default};
