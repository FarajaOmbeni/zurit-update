import{r as O,B as m,k as G,W as P,b as c,o as i,d as g,u as B,m as V,w as N,a as t,D as _,c as z,f as E,t as a,M,I as D,F as v,G as A,N as U}from"./app-VkLrrOBV.js";import{A as H}from"./AuthenticatedLayout-Bb0fJIL_.js";import{_ as W}from"./Sidebar-DGBfm4I3.js";import{_ as j}from"./BudgetBarChart-BZvt5k65.js";import{f as q}from"./useDateFormat-pjOuPPEs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useFormatCurrency-DPZVhC5N.js";const Q={class:"w-full text-gray-900"},R={class:"py-6"},X={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Z={class:"flex justify-between"},tt={class:"text-2xl font-semibold text-gray-900"},et={key:1,class:"mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3"},st={class:"bg-white overflow-hidden shadow rounded-lg"},ot={class:"px-4 py-5 sm:p-6"},nt={class:"mt-1 text-3xl font-semibold text-green-600"},at={class:"bg-white overflow-hidden shadow rounded-lg"},lt={class:"px-4 py-5 sm:p-6"},rt={class:"mt-1 text-3xl font-semibold text-red-500"},dt={class:"bg-white overflow-hidden shadow rounded-lg"},it={class:"px-4 py-5 sm:p-6"},ct={class:"my-4 w-[50%] flex flex-col items-center justify-center mx-auto"},ut=["value"],mt={key:2,class:"mt-8 grid grid-cols-1 gap-8 lg:grid-cols-2"},pt={class:"mt-12"},xt={class:"text-xl font-bold text-gray-900 text-center"},ht={class:"mt-4 bg-white shadow rounded-lg"},gt={class:"divide-y divide-gray-200"},_t={class:"flex items-center justify-between"},vt={class:"text-sm font-medium text-gray-900"},yt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},ft={class:"text-green-600 font-medium"},bt={class:"px-4 py-3 bg-gray-50"},wt={class:"flex items-center justify-between"},St={class:"text-sm font-bold text-green-600"},Et={class:"mt-12"},Mt={class:"text-xl font-bold text-gray-900 text-center"},At={class:"mt-4 bg-white shadow rounded-lg"},Tt={class:"divide-y divide-gray-200"},Dt={class:"flex items-center justify-between"},It={class:"text-sm font-medium text-gray-900"},Lt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},kt={class:"text-red-600 font-medium"},Ot={class:"px-4 py-3 bg-gray-50"},Bt={class:"flex items-center justify-between"},Nt={class:"text-sm font-bold text-red-600"},jt={class:"mt-12"},Ft={class:"text-xl font-bold text-center text-gray-900"},Kt={class:"mt-4 bg-white shadow rounded-lg"},Ct={class:"divide-y divide-gray-200"},Yt={key:0,class:"px-4 py-6 text-center text-gray-500"},Jt={class:"flex items-center justify-between"},$t={class:"text-sm font-medium text-gray-900"},Gt={class:"text-sm text-gray-500"},Pt={class:"flex flex-col gap-2 md:flex-row md:gap-0 text-sm items-center space-x-2"},Vt={class:"px-4 py-3 bg-gray-50 border-t border-gray-200"},zt={class:"flex justify-between items-center"},Ut={class:"text-sm font-medium text-gray-700"},Ht={class:"text-right"},Wt={class:"text-sm font-medium text-green-600"},qt={class:"text-sm font-medium text-red-600"},oe={__name:"Budgets",props:{data:Object,today:String},setup(F){const d=F,u=O(null),y=O([]),f=m(()=>u.value?(d.data.transactions||[]).filter(o=>{const e=new Date(o.transaction_date);return I(e)===u.value}):[]),T=m(()=>f.value.filter(o=>o.type==="income")),h=m(()=>f.value.filter(o=>o.type!=="income")),b=m(()=>T.value.reduce((o,e)=>o+parseFloat(e.amount),0)),w=m(()=>h.value.reduce((o,e)=>o+parseFloat(e.amount),0)),S=m(()=>b.value-w.value),K=m(()=>{const l=T.value.reduce((s,n)=>{const r=n.category;return s[r]||(s[r]={totalAmount:0,incomes:[]}),s[r].totalAmount+=parseFloat(n.amount),s[r].incomes.push(n),s},{});return Object.entries(l).map(([s,{totalAmount:n}])=>({label:s,amount:Math.round(n)})).sort((s,n)=>n.amount-s.amount).slice(0,3)}),C=m(()=>{const l=h.value.reduce((n,r)=>{const p=r.category;return n[p]||(n[p]=[]),n[p].push(r),n},{});return Object.entries(l).map(([n,r])=>({category:n,totalAmount:r.reduce((p,$)=>p+parseFloat($.amount),0),expenses:r})).sort((n,r)=>r.totalAmount-n.totalAmount).slice(0,3).map(n=>({label:n.category,amount:Math.round(n.totalAmount),expenses:n.expenses}))}),Y=m(()=>!h.value||h.value.length===0?{}:h.value.reduce((o,e)=>{const l=e.category;return o[l]||(o[l]=0),o[l]+=parseFloat(e.amount),o},{})),x=m(()=>d.data&&(d.data.incomes&&d.data.incomes.length||d.data.expenses&&d.data.expenses.length||d.data.goals&&d.data.goals.length||d.data.debts&&d.data.debts.length||d.data.investments&&d.data.investments.length));G(()=>{J()});function J(){const o={};(d.data.transactions||[]).forEach(e=>{if(e.transaction_date){const l=new Date(e.transaction_date);if(isNaN(l.getTime()))console.warn("Invalid transaction_date:",e.transaction_date);else{const s=I(l);o[s]=!0}}}),y.value=Object.keys(o).sort((e,l)=>{const[s,n]=e.split(" "),[r,p]=l.split(" ");return parseInt(p)-parseInt(n)||L(r)-L(s)}),y.value.length>0&&k(y.value[0])}function I(o){return`${["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]} ${o.getFullYear()}`}function L(o){return["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(o.split(" ")[0])}function k(o){u.value=o}return(o,e)=>{const l=P("Alert");return i(),c(v,null,[g(B(V),{title:"Dashboard"}),g(H,null,{default:N(()=>[t("div",Q,[g(W,null,{default:N(()=>[t("div",R,[t("div",X,[_(t("div",Z,[t("div",null,[t("h1",tt,a(u.value)+"'s Budget",1)])],512),[[M,x.value]]),o.alertState?(i(),z(l,{key:0,type:o.alertState.type,message:o.alertState.message,duration:o.alertState.duration,"auto-close":o.alertState.autoClose,onClose:o.clearAlert},null,8,["type","message","duration","auto-close","onClose"])):E("",!0),x.value?(i(),c("div",et,[t("div",st,[t("div",ot,[e[2]||(e[2]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Income",-1)),t("dd",nt,"KES "+a(b.value.toLocaleString()),1)])]),t("div",at,[t("div",lt,[e[3]||(e[3]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Expenses",-1)),t("dd",rt,"KES "+a(w.value.toLocaleString()),1)])]),t("div",dt,[t("div",it,[e[4]||(e[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Balance",-1)),t("dd",{class:D(["mt-1 text-3xl font-semibold",S.value>=0?"text-green-600":"text-red-600"])}," KES "+a(S.value.toLocaleString()),3)])])])):E("",!0),t("div",ct,[e[5]||(e[5]=t("label",{for:"monthSelect",class:"block text-sm font-medium text-gray-700 mb-1"},"Select Month",-1)),_(t("select",{id:"monthSelect","onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),onChange:e[1]||(e[1]=s=>k(u.value)),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[(i(!0),c(v,null,A(y.value,(s,n)=>(i(),c("option",{key:n,value:s},a(s),9,ut))),128))],544),[[U,u.value]])]),x.value?(i(),c("div",mt,[g(j,{title:"Top Income Sources",items:K.value,type:"income",class:"bg-white shadow rounded-lg"},null,8,["items"]),g(j,{title:"Top Expenses",items:C.value,type:"expense",class:"bg-white shadow rounded-lg"},null,8,["items"])])):E("",!0),_(t("div",pt,[t("h2",xt,"Your Income - "+a(u.value),1),t("div",ht,[t("ul",gt,[(i(!0),c(v,null,A(T.value,s=>(i(),c("li",{key:s.id,class:"px-4 py-3"},[t("div",_t,[t("div",null,[t("p",vt,a(s.category)+" - "+a(s.description),1)]),t("div",yt,[t("div",ft," + KES "+a(Math.round(parseFloat(s.amount)).toLocaleString()),1)])])]))),128)),t("li",bt,[t("div",wt,[e[6]||(e[6]=t("div",null,[t("p",{class:"text-sm font-bold text-gray-900"}," TOTAL INCOME ")],-1)),t("div",St," KES "+a(b.value.toLocaleString()),1)])])])])],512),[[M,x.value]]),_(t("div",Et,[t("h2",Mt,"Your Budget - "+a(u.value),1),t("div",At,[t("ul",Tt,[(i(!0),c(v,null,A(Y.value,(s,n)=>(i(),c("li",{key:n,class:"px-4 py-3"},[t("div",Dt,[t("div",null,[t("p",It,a(n),1)]),t("div",Lt,[t("div",kt," - KES "+a(Math.round(parseFloat(s)).toLocaleString()),1)])])]))),128)),t("li",Ot,[t("div",Bt,[e[7]||(e[7]=t("div",null,[t("p",{class:"text-sm font-bold text-gray-900"}," TOTAL MONTHLY BUDGET ")],-1)),t("div",Nt," KES "+a(w.value.toLocaleString()),1)])])])])],512),[[M,x.value]]),_(t("div",jt,[t("h2",Ft,"All Transactions - "+a(u.value),1),t("div",Kt,[t("ul",Ct,[f.value.length===0?(i(),c("li",Yt," No transactions right now. Add the first transaction. ")):E("",!0),(i(!0),c(v,null,A(f.value,s=>(i(),c("li",{key:s.id,class:"px-4 py-3"},[t("div",Jt,[t("div",null,[t("p",$t,a(s.description),1),t("p",Gt,a(B(q)(s.transaction_date)),1)]),t("div",Pt,[t("div",{class:D([s.type==="income"?"text-green-600":"text-red-600","font-medium"])},a(s.type==="income"?"+":"-")+" KES "+a(Math.round(s.amount).toLocaleString()),3)])])]))),128))]),t("div",Vt,[t("div",zt,[t("span",Ut,a(u.value)+" Summary:",1),t("div",Ht,[t("p",Wt,"Income: KES "+a(b.value.toLocaleString()),1),t("p",qt,"Expenses: KES "+a(w.value.toLocaleString()),1),t("p",{class:D(["text-sm font-bold",S.value>=0?"text-green-600":"text-red-600"])}," Balance: KES "+a(S.value.toLocaleString()),3)])])])])],512),[[M,x.value]])])])]),_:1})])]),_:1})],64)}}};export{oe as default};
