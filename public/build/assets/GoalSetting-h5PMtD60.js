import{r as h,y as z,i as N,C as H,b as g,o as i,c as M,f as S,a as t,u as l,j as p,t as f,L as C,d as _,h as A,O,U as R,g as $,H as x,F as V,W,m as X,w as F,k as B}from"./app-DKFtR5jf.js";import{A as Y}from"./AuthenticatedLayout-BQGjP1mX.js";import{_ as J}from"./Sidebar-DSlTtGJA.js";import{f as Q}from"./useDateFormat-pjOuPPEs.js";import{u as I,_ as K}from"./useAlert-yE-xuASw.js";import{P as Z,T as tt,X as q}from"./x-DrSnDMgt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const et={class:"bg-white shadow rounded-lg p-4 border-2 border-purple-500"},st={class:"flex justify-between items-center border-b pb-2 mb-2"},ot={class:"text-lg font-semibold text-purple-700"},lt={class:"flex items-center space-x-2"},at={class:"mt-1"},rt={class:"mt-1"},nt={class:"mt-1"},dt={class:"w-full bg-gray-200 rounded-full h-2.5 mt-2"},ut={class:"flex justify-between items-center mb-2"},it={class:"grid grid-cols-2 gap-x-2 gap-y-2"},pt={class:"col-span-2"},gt={class:"col-span-2"},mt={class:"col-span-1"},ct={class:"col-span-1"},ft={class:"col-span-2"},xt={class:"mt-3 flex justify-end space-x-2"},vt=["disabled"],bt={class:"flex justify-between items-center mb-4"},yt={class:"flex justify-end space-x-3"},wt={class:"px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},P={__name:"GoalCard",props:{goal:Object},emits:["update","delete"],setup(U,{emit:w}){const{alertState:b,openAlert:k,clearAlert:D}=I(),m=U,G=w,a=h({...m.goal});z(()=>m.goal,d=>{a.value={...d}},{deep:!0});const T=N(()=>a.value.target_amount===0?0:Math.min(100,a.value.current_amount/a.value.target_amount*100)),y=d=>"KES "+Math.round(d).toLocaleString(),v=h(!1),o=H({name:"",description:"",target_amount:"",start_date:"",target_date:""}),L=()=>{o.name=a.value.name,o.description=a.value.description,o.target_amount=a.value.target_amount,o.start_date=new Date(a.value.start_date).toISOString().split("T")[0]||"",o.target_date=new Date(a.value.target_date).toISOString().split("T")[0]||""},E=()=>{v.value=!1};z(v,d=>{d&&L()});const j=()=>{o.put(route("goal.update",a.value.id),{preserveScroll:!0,onSuccess:d=>{var e;(e=d==null?void 0:d.props)!=null&&e.goal?a.value=d.props.goal:a.value={...a.value,name:o.name,description:o.description,target_amount:o.target_amount,start_date:o.start_date,target_date:o.target_date},v.value=!1,k("success","Goal Updated Successfully."),G("update",a.value)},onError:d=>{const e=Object.values(d).flat().join(" ");k("danger",e,5e3)}})},c=h(!1),n=()=>{c.value=!1},s=h(!1),r=()=>{s.value=!0,W.post(route("goal.destroy",a.value.id)).then(()=>{c.value=!1,k("success","Goal deleted successfully."),G("delete",a.value.id)}).catch(d=>{s.value=!1,k("danger","Failed to delete goal. Please try again.",5e3),console.error("Error deleting goal:",d)})};return(d,e)=>(i(),g(V,null,[l(b)?(i(),M(K,{key:0,type:l(b).type,message:l(b).message,duration:l(b).duration,"auto-close":l(b).autoClose,onClose:l(D)},null,8,["type","message","duration","auto-close","onClose"])):S("",!0),t("div",et,[t("div",st,[t("h3",ot,f(a.value.name),1),t("div",lt,[t("span",{class:C(["px-2 py-1 text-xs font-bold uppercase rounded-full",{"bg-yellow-400 text-black":a.value.status==="in_progress","bg-green-500 text-white":a.value.status==="achieved","bg-gray-400 text-black":a.value.status==="abandoned"}])},f(a.value.status),3),t("button",{onClick:e[0]||(e[0]=u=>v.value=!0),class:C(["p-1 text-purple-600 hover:text-purple-800 transition-colors",{hidden:a.value.status==="achieved"}])},[_(l(Z),{class:"h-4 w-4"})],2),t("button",{onClick:e[1]||(e[1]=u=>c.value=!0),class:C(["p-1 text-red-600 hover:text-red-800 transition-colors",{hidden:a.value.status==="achieved"}])},[_(l(tt),{class:"h-4 w-4"})],2)])]),t("div",{class:C(["mb-2",a.value.status==="in_progress"?"text-gray-600":"text-green-500"])},[t("p",null,f(a.value.description),1),t("p",at,[e[13]||(e[13]=t("strong",null,"Goal:",-1)),A(" "+f(y(a.value.target_amount)),1)]),t("p",rt,[e[14]||(e[14]=t("strong",null,"Saved:",-1)),A(" "+f(y(a.value.current_amount)),1)]),p(t("p",nt,[e[15]||(e[15]=t("strong",null,"Remaining:",-1)),A(" "+f(y(a.value.target_amount-a.value.current_amount)),1)],512),[[O,a.value.status==="in_progress"]]),t("div",dt,[t("div",{class:C([a.value.status==="in_progress"?"bg-yellow-400":"bg-green-500","h-2.5 rounded-full"]),style:R({width:T.value+"%"})},null,6)])],2),p(t("div",{class:"text-right text-sm text-gray-500"}," Target Date: "+f(l(Q)(a.value.target_date)),513),[[O,a.value.status==="in_progress"]]),v.value?(i(),g("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:E},[t("div",{class:"bg-white rounded-lg p-3 w-full max-w-sm mx-4",onClick:e[9]||(e[9]=$(()=>{},["stop"]))},[t("div",ut,[e[16]||(e[16]=t("h3",{class:"text-base font-medium text-purple-700"},"Edit Goal",-1)),t("button",{onClick:e[2]||(e[2]=u=>v.value=!1),class:"text-gray-500 hover:text-gray-700"},[_(l(q),{class:"h-4 w-4"})])]),t("form",{onSubmit:$(j,["prevent"])},[t("div",it,[t("div",pt,[e[17]||(e[17]=t("label",{for:"name",class:"block text-xs font-medium text-gray-700"},"Name",-1)),p(t("input",{type:"text",id:"name","onUpdate:modelValue":e[3]||(e[3]=u=>l(o).name=u),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[x,l(o).name]])]),t("div",gt,[e[18]||(e[18]=t("label",{for:"target_amount",class:"block text-xs font-medium text-gray-700"},"Target Amount",-1)),p(t("input",{type:"number",id:"target_amount","onUpdate:modelValue":e[4]||(e[4]=u=>l(o).target_amount=u),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[x,l(o).target_amount]])]),t("div",mt,[e[19]||(e[19]=t("label",{for:"start_date",class:"block text-xs font-medium text-gray-700"},"Start Date",-1)),p(t("input",{type:"date",id:"start_date","onUpdate:modelValue":e[5]||(e[5]=u=>l(o).start_date=u),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[x,l(o).start_date]])]),t("div",ct,[e[20]||(e[20]=t("label",{for:"target_date",class:"block text-xs font-medium text-gray-700"},"Target Date",-1)),p(t("input",{type:"date",id:"target_date","onUpdate:modelValue":e[6]||(e[6]=u=>l(o).target_date=u),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[x,l(o).target_date]])]),t("div",ft,[e[21]||(e[21]=t("label",{for:"description",class:"block text-xs font-medium text-gray-700"},"Description",-1)),p(t("textarea",{id:"description","onUpdate:modelValue":e[7]||(e[7]=u=>l(o).description=u),rows:"2",class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[x,l(o).description]])])]),t("div",xt,[t("button",{type:"button",onClick:e[8]||(e[8]=u=>v.value=!1),class:"px-2 py-1 border border-gray-300 rounded-md shadow-sm text-xs font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),t("button",{type:"submit",disabled:l(o).processing,class:"px-2 py-1 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-1 focus:ring-purple-500"},f(l(o).processing?"Saving...":"Save Changes"),9,vt)])],32)])])):S("",!0),c.value?(i(),g("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:n},[t("div",{class:"bg-white rounded-lg p-5 w-full max-w-sm mx-4",onClick:e[12]||(e[12]=$(()=>{},["stop"]))},[t("div",bt,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-red-600"},"Delete Goal",-1)),t("button",{onClick:e[10]||(e[10]=u=>c.value=!1),class:"text-gray-500 hover:text-gray-700"},[_(l(q),{class:"h-5 w-5"})])]),e[23]||(e[23]=t("p",{class:"text-gray-700 mb-4"},"Are you sure you want to delete this goal? This action cannot be undone. ",-1)),t("div",yt,[t("button",{onClick:e[11]||(e[11]=u=>c.value=!1),class:"px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),t("form",{onSubmit:$(r,["prevent"])},[t("button",wt,f(s.value?"Deleting...":"Delete"),1)],32)])])])):S("",!0)])],64))}},_t={class:"w-full text-gray-900"},kt={class:"container mx-auto p-4"},ht={class:"container mx-auto p-4"},Ct={class:"mb-8"},$t={key:0,class:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},St={key:1,class:"text-gray-600"},Dt={key:0,class:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},Gt={key:1,class:"text-gray-600"},jt={class:"bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 overflow-hidden"},Mt={class:"grid grid-cols-2 gap-x-2 gap-y-2"},At={class:"col-span-2"},Vt={class:"col-span-2"},Ut={class:"relative"},Tt={class:"col-span-1"},Lt={class:"col-span-1"},Et={class:"col-span-2"},Nt={class:"flex justify-end space-x-2 mt-3"},Ot={type:"submit",class:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-1 focus:ring-purple-500"},Kt={__name:"GoalSetting",props:{goals:Array},setup(U){const{alertState:w,openAlert:b,clearAlert:k}=I(),D=U,m=h([...D.goals]),G=n=>{m.value=m.value.filter(s=>s.id!==n)},a=h(!1),T=()=>{a.value=!0},y=()=>{a.value=!1,L()},v=n=>{n.target.classList.contains("modal-overlay")&&y()},o=H({name:"",description:"",target_amount:"",start_date:"",target_date:""}),L=()=>{o.reset()},E=()=>{o.post(route("goal.store"),{onSuccess:n=>{var s;if((s=n==null?void 0:n.props)!=null&&s.goal)m.value.push(n.props.goal);else{const r={id:Date.now(),name:o.name,description:o.description,target_amount:o.target_amount,start_date:o.start_date,target_date:o.target_date,status:"active",current_amount:0,progress_percentage:0};m.value.push(r)}o.reset(),y(),b("success","Goal added successfully",5e3)},onError:n=>{const s=Object.values(n).flat().join(" ");b("danger",s,5e3)}})},j=N(()=>m.value.filter(n=>n.status!=="achieved")),c=N(()=>m.value.filter(n=>n.status==="achieved"));return(n,s)=>(i(),g(V,null,[_(l(X),{title:"Dashboard"}),_(Y,null,{default:F(()=>[t("div",_t,[_(J,null,{default:F(()=>[t("div",kt,[t("div",{class:"flex justify-between items-center mb-6"},[s[7]||(s[7]=t("h1",{class:"text-2xl font-bold text-purple-700"},"Your Goals",-1)),t("button",{onClick:T,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},s[6]||(s[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),A(" Add Goal ")]))]),t("div",ht,[l(w)?(i(),M(K,{key:0,type:l(w).type,message:l(w).message,duration:l(w).duration,"auto-close":l(w).autoClose,onClose:l(k)},null,8,["type","message","duration","auto-close","onClose"])):S("",!0),t("section",Ct,[s[8]||(s[8]=t("h2",{class:"text-xl font-semibold text-purple-700 mb-4"},"Active Goals",-1)),j.value.length?(i(),g("div",$t,[(i(!0),g(V,null,B(j.value,r=>(i(),M(P,{key:r.id||r.goal_id,goal:r,onUpdate:s[0]||(s[0]=d=>m.value.value=[...D.goals]),onDelete:G},null,8,["goal"]))),128))])):(i(),g("div",St," No active goals found. "))]),p(t("section",null,[s[9]||(s[9]=t("h2",{class:"text-xl font-semibold text-purple-700 mb-4"},"Completed Goals",-1)),c.value.length?(i(),g("div",Dt,[(i(!0),g(V,null,B(c.value,r=>(i(),M(P,{key:r.id||r.goal_id,goal:r},null,8,["goal"]))),128))])):(i(),g("div",Gt," No completed goals found. "))],512),[[O,c.value.length>0]])])])]),_:1})]),a.value?(i(),g("div",{key:0,onClick:v,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay"},[t("div",jt,[t("div",{class:"bg-purple-600 text-white px-3 py-2 flex justify-between items-center"},[s[11]||(s[11]=t("h3",{class:"text-base font-medium"},"Add New Goal",-1)),t("button",{onClick:y,class:"text-white hover:text-gray-200 focus:outline-none"},s[10]||(s[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),t("form",{onSubmit:$(E,["prevent"]),class:"p-3"},[t("div",Mt,[t("div",At,[s[12]||(s[12]=t("label",{for:"name",class:"block text-gray-700 text-xs font-medium mb-1"},"Name",-1)),p(t("input",{type:"text",id:"name","onUpdate:modelValue":s[1]||(s[1]=r=>l(o).name=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[x,l(o).name]])]),t("div",Vt,[s[14]||(s[14]=t("label",{for:"target_amount",class:"block text-gray-700 text-xs font-medium mb-1"},"Target Amount",-1)),t("div",Ut,[s[13]||(s[13]=t("div",{class:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 text-xs"},"KES")],-1)),p(t("input",{type:"number",id:"target_amount","onUpdate:modelValue":s[2]||(s[2]=r=>l(o).target_amount=r),class:"w-full pl-8 pr-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",step:"0.01",min:"0",required:""},null,512),[[x,l(o).target_amount]])])]),t("div",Tt,[s[15]||(s[15]=t("label",{for:"start_date",class:"block text-gray-700 text-xs font-medium mb-1"},"Start Date",-1)),p(t("input",{type:"date",id:"start_date","onUpdate:modelValue":s[3]||(s[3]=r=>l(o).start_date=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[x,l(o).start_date]])]),t("div",Lt,[s[16]||(s[16]=t("label",{for:"target_date",class:"block text-gray-700 text-xs font-medium mb-1"},"Target Date",-1)),p(t("input",{type:"date",id:"target_date","onUpdate:modelValue":s[4]||(s[4]=r=>l(o).target_date=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[x,l(o).target_date]])]),t("div",Et,[s[17]||(s[17]=t("label",{for:"description",class:"block text-gray-700 text-xs font-medium mb-1"},"Description",-1)),p(t("textarea",{id:"description","onUpdate:modelValue":s[5]||(s[5]=r=>l(o).description=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",rows:"2"},null,512),[[x,l(o).description]])])]),t("div",Nt,[t("button",{type:"button",onClick:y,class:"px-2 py-1 text-xs border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-purple-500"}," Cancel "),t("button",Ot,f(l(o).processing?"Saving...":"Add Goal"),1)])],32)])])):S("",!0)]),_:1})],64))}};export{Kt as default};
