import{b as c,o as d,a as e,r as b,p as B,C as N,d as r,f as y,u as l,m as re,w as E,c as ie,t as i,h,g as de,F as S,i as F,P as ce,n as ue}from"./app-Beo4ItwT.js";import{A as me}from"./AuthenticatedLayout-ueg2KzGX.js";import{_ as pe}from"./Sidebar-BLYFEQMp.js";import{_ as fe}from"./DashboardBackButton-DXe3P3lP.js";import{_ as ve,r as H,a as O}from"./LegacyProgress-a6BMIr8V.js";import{_ as V}from"./Input-CTEBI7vO.js";import{_ as L}from"./Select-BFzLsqnA.js";import{_ as ge}from"./Alert-D4vUwmIe.js";import{u as be}from"./useAlert-BXHLJ6Ln.js";import{r as ye}from"./CalendarIcon-0Nv1i96T.js";import{r as xe}from"./PencilIcon-D33_BRG3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                */import"./EllipsisHorizontalIcon-CXhkN-_T.js";import"./AcademicCapIcon-BxSvzwyG.js";import"./UserIcon-CImU51LK.js";import"./ChartBarIcon-CkJeh_d0.js";import"./HomeIcon-CdmROl8M.js";function he(x,A){return d(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"})])}function R(x,A){return d(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})])}const _e={class:"w-full text-gray-900"},we={class:"max-w-6xl mx-auto p-6"},Ae={class:"flex justify-between items-center mb-8"},ke={class:"text-right"},Ve={class:"text-2xl font-bold text-green-600"},Ce={class:"text-sm text-gray-500 mt-1"},$e={class:"mb-6"},je={key:1,class:"bg-white rounded-lg shadow-sm border p-6 mb-8"},De={class:"text-lg font-semibold text-gray-900 mb-4"},Me={class:"grid md:grid-cols-2 gap-4"},Se={class:"grid md:grid-cols-2 gap-4"},Ee={class:"flex space-x-4"},Fe=["disabled"],Te={key:2,class:"space-y-4 mb-8"},qe={class:"grid gap-4"},Ue={class:"flex items-start justify-between"},Be={class:"flex-1"},Ne={class:"flex items-center space-x-3 mb-2"},He={class:"text-lg font-semibold text-gray-900"},Oe={class:"text-sm text-gray-500"},Le={key:0,class:"text-gray-600 mb-3"},Re={class:"flex items-center space-x-6 text-sm text-gray-500"},ze={class:"flex items-center space-x-1"},Pe={class:"flex items-center space-x-1"},Ye={class:"mt-4"},Ie={class:"flex items-center justify-between mb-2"},Ke={class:"text-sm text-gray-600"},Ze=["onClick"],Je={key:0,class:"space-y-1"},Ge={class:"text-gray-700"},Qe={class:"text-gray-900 font-medium"},We={class:"text-xs text-gray-500 mt-1"},Xe={class:"flex items-center space-x-2 ml-4"},et=["onClick"],tt=["onClick"],st={key:3,class:"text-center py-12"},ot={key:4,class:"flex justify-end pt-8 border-t"},lt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},at={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},nt={class:"p-6"},rt={class:"flex items-center mb-4"},it={class:"flex-shrink-0"},dt={class:"mb-6"},ct={class:"text-gray-600"},ut={class:"flex space-x-4"},mt=["disabled"],pt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ft={class:"bg-white rounded-lg shadow-xl max-w-xl w-full mx-4"},vt={class:"p-6"},gt={class:"mb-4"},bt={class:"text-gray-600 text-sm"},yt={class:"flex items-center justify-between mb-3"},xt={class:"text-sm text-gray-600"},ht={key:0,class:"text-gray-600 text-sm mb-4"},_t={class:"space-y-3 max-h-80 overflow-y-auto mb-4"},wt={class:"md:col-span-4"},At={class:"md:col-span-2"},kt={class:"md:col-span-6 flex justify-end"},Vt=["onClick"],Ct={class:"flex space-x-4"},$t=["disabled"],It={__name:"Assets",props:{assets:{type:Array,default:()=>[]},beneficiaries:{type:Array,default:()=>[]}},setup(x){const A=x,{openAlert:v,clearAlert:z,alertState:k}=be(),p=b(!1),C=b(!1),f=b(null),_=b(null),$=b(!1),j=b(!1),D=b(null),g=b([]),P=B(()=>A.beneficiaries.map(s=>({value:s.id,label:s.full_name}))),M=B(()=>g.value.reduce((s,t)=>s+(parseFloat(t.percentage)||0),0)),a=N({name:"",type:"",description:"",value:"",acquisition_date:""}),T=[{value:"real_estate",label:"Real Estate"},{value:"vehicle",label:"Vehicle"},{value:"bank_account",label:"Bank Account"},{value:"investment",label:"Investment"},{value:"business",label:"Business"},{value:"jewelry",label:"Jewelry"},{value:"artwork",label:"Artwork"},{value:"electronics",label:"Electronics"},{value:"furniture",label:"Furniture"},{value:"other",label:"Other"}];function Y(){f.value?a.put(route("legacy.assets.update",f.value.id),{onSuccess:()=>{a.reset(),p.value=!1,f.value=null,v("success","Asset updated successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}}):a.post(route("legacy.assets.store"),{onSuccess:()=>{a.reset(),p.value=!1,v("success","Asset added successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}})}function q(s){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(s)}function I(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not specified"}function K(s){if(!s)return"";const t=new Date(s),n=t.getFullYear(),u=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${n}-${u}-${o}`}function Z(s){const t=T.find(n=>n.value===s);return t?t.label:s}function J(){return A.assets.reduce((s,t)=>s+parseFloat(t.value||0),0)}function w(s){return(s.beneficiary_allocations||s.beneficiaryAllocations||[]).map(n=>{var u,o;return{id:n.id,beneficiary_id:n.beneficiary_id||((u=n.beneficiary)==null?void 0:u.id),beneficiary_name:(o=n.beneficiary)==null?void 0:o.full_name,percentage:n.percentage}}).filter(n=>n.beneficiary_id)}function G(){return A.assets.filter(s=>w(s).length>0).length}function Q(s){f.value=s,a.name=s.name,a.type=s.type,a.description=s.description||"",a.value=s.value,a.acquisition_date=s.acquisition_date?K(s.acquisition_date):"",p.value=!0}function U(){f.value=null,a.reset(),p.value=!1}function W(s){_.value=s,C.value=!0}function X(){_.value&&a.delete(route("legacy.assets.destroy",_.value.id),{onSuccess:()=>{C.value=!1,_.value=null,v("success","Asset deleted successfully!",5e3)},onError:s=>{const t=Object.values(s).flat().join(" ");v("danger",t,1e4)}})}function ee(){C.value=!1,_.value=null}async function te(s){D.value=s,g.value=w(s).map(t=>({beneficiary_id:t.beneficiary_id,percentage:t.percentage})),$.value=!0,j.value=!0;try{const t=route("legacy.asset-allocation.status")+`?asset_id=${s.id}`,n=await fetch(t,{headers:{Accept:"application/json"}});if(n.ok){const u=await n.json();g.value=(u.allocations||[]).map(o=>({beneficiary_id:o.beneficiary_id,percentage:o.percentage}))}}catch{}finally{j.value=!1}}function se(){g.value.push({beneficiary_id:null,percentage:0})}function oe(s){g.value.splice(s,1)}function le(){const s=g.value.map(n=>n.beneficiary_id).filter(Boolean),t=new Set(s);return s.length!==t.size?(v("danger","Each beneficiary can only be allocated once per asset.",8e3),!1):M.value>100.01?(v("danger",`Total allocation cannot exceed 100%. Current: ${M.value}%`,8e3),!1):(g.value=g.value.filter(n=>n.beneficiary_id!=null),!0)}function ae(){if(!D.value||!le())return;const s={asset_id:D.value.id,beneficiary_allocations:g.value.map(n=>({beneficiary_id:n.beneficiary_id,percentage:Number(n.percentage)||0}))};N(s).post(route("legacy.asset-allocation.store"),{preserveScroll:!0,onSuccess:()=>{$.value=!1,v("success","Allocations saved successfully!",5e3)},onError:n=>{const u=Object.values(n).flat().join(" ");v("danger",u||"Could not save allocations.",1e4)}})}return(s,t)=>{var n;return d(),c(S,null,[r(l(re),{title:"Assets - Legacy & Estate Planning"}),r(me,null,{default:E(()=>{var u;return[e("div",_e,[r(pe,null,{default:E(()=>[r(fe),e("div",we,[l(k)?(d(),ie(ge,{key:0,type:l(k).type,message:l(k).message,duration:l(k).duration,"auto-close":l(k).autoClose,onClose:l(z)},null,8,["type","message","duration","auto-close","onClose"])):y("",!0),e("div",Ae,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"}," Step 1: Your Assets "),e("p",{class:"text-gray-600"}," Document all your assets that will be part of your estate plan. ")],-1)),e("div",ke,[t[9]||(t[9]=e("div",{class:"text-sm text-gray-500 mb-1"},"Total Asset Value",-1)),e("div",Ve,i(q(J())),1),e("div",Ce,i(G())+"/"+i(x.assets.length)+" assets allocated ",1)])]),r(ve,{current:1}),e("div",$e,[e("button",{onClick:t[0]||(t[0]=o=>p.value?f.value?U():p.value=!1:p.value=!0),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[r(l(H),{class:"w-5 h-5 mr-2"}),h(" "+i(p.value?"Cancel":"Add Asset"),1)])]),p.value?(d(),c("div",je,[e("h3",De,i(f.value?"Edit Asset":"Add New Asset"),1),e("form",{onSubmit:de(Y,["prevent"]),class:"space-y-4"},[e("div",Me,[r(V,{modelValue:l(a).name,"onUpdate:modelValue":t[1]||(t[1]=o=>l(a).name=o),label:"Asset Name",placeholder:"e.g., Family Home, Toyota Camry",error:l(a).errors.name,required:""},null,8,["modelValue","error"]),r(L,{modelValue:l(a).type,"onUpdate:modelValue":t[2]||(t[2]=o=>l(a).type=o),label:"Asset Type",options:T,error:l(a).errors.type,required:""},null,8,["modelValue","error"])]),e("div",Se,[r(V,{modelValue:l(a).value,"onUpdate:modelValue":t[3]||(t[3]=o=>l(a).value=o),type:"number",step:"0.01",min:"0",label:"Estimated Value (KES)",placeholder:"0.00",error:l(a).errors.value,required:""},null,8,["modelValue","error"]),r(V,{modelValue:l(a).acquisition_date,"onUpdate:modelValue":t[4]||(t[4]=o=>l(a).acquisition_date=o),type:"date",label:"Acquisition Date (Optional)",error:l(a).errors.acquisition_date},null,8,["modelValue","error"])]),r(V,{modelValue:l(a).description,"onUpdate:modelValue":t[5]||(t[5]=o=>l(a).description=o),label:"Description (Optional)",placeholder:"Additional details about the asset",error:l(a).errors.description},null,8,["modelValue","error"]),e("div",Ee,[e("button",{type:"submit",disabled:l(a).processing,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},i(l(a).processing?f.value?"Updating...":"Adding...":f.value?"Update Asset":"Add Asset"),9,Fe),e("button",{type:"button",onClick:t[6]||(t[6]=o=>f.value?U():p.value=!1),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])],32)])):y("",!0),x.assets.length>0?(d(),c("div",Te,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Your Assets",-1)),e("div",qe,[(d(!0),c(S,null,F(x.assets,o=>(d(),c("div",{key:o.id,class:"bg-white rounded-lg shadow-sm border p-6 hover:shadow-md transition-shadow"},[e("div",Ue,[e("div",Be,[e("div",Ne,[r(l(R),{class:"w-6 h-6 text-blue-600 flex-shrink-0"}),e("div",null,[e("h4",He,i(o.name),1),e("p",Oe,i(Z(o.type)),1)])]),o.description?(d(),c("div",Le,i(o.description),1)):y("",!0),e("div",Re,[e("div",ze,[r(l(he),{class:"w-4 h-4"}),e("span",null,i(q(o.value)),1)]),e("div",Pe,[r(l(ye),{class:"w-4 h-4"}),e("span",null,i(I(o.acquisition_date)),1)])]),e("div",Ye,[e("div",Ie,[e("div",Ke,[t[11]||(t[11]=e("span",{class:"font-medium"},"Allocations:",-1)),e("span",null,i(w(o).length>0?"":"None yet"),1)]),e("button",{onClick:m=>te(o),type:"button",class:"text-purple-700 hover:text-purple-800 text-sm font-medium"}," Manage Allocations ",8,Ze)]),w(o).length>0?(d(),c("div",Je,[(d(!0),c(S,null,F(w(o),m=>(d(),c("div",{key:m.beneficiary_id,class:"flex items-center justify-between text-sm"},[e("span",Ge,i(m.beneficiary_name),1),e("span",Qe,i(m.percentage)+"%",1)]))),128)),e("div",We," Total: "+i(w(o).reduce((m,ne)=>m+(parseFloat(ne.percentage)||0),0))+"% ",1)])):y("",!0)])]),e("div",Xe,[e("button",{onClick:m=>Q(o),class:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",title:"Edit Asset"},[r(l(xe),{class:"w-5 h-5"})],8,et),e("button",{onClick:m=>W(o),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete Asset"},[r(l(O),{class:"w-5 h-5"})],8,tt)])])]))),128))])])):(d(),c("div",st,[r(l(R),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No assets added yet",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-6"}," Start by adding your first asset to begin your estate plan. ",-1)),e("button",{onClick:t[7]||(t[7]=o=>{f.value=null,p.value=!0}),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},[r(l(H),{class:"w-5 h-5 mr-2"}),t[13]||(t[13]=h(" Add Your First Asset "))])])),x.assets.length>0?(d(),c("div",ot,[r(l(ce),{href:s.route("legacy.beneficiaries"),class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},{default:E(()=>t[16]||(t[16]=[h(" Continue to Beneficiaries → ")])),_:1},8,["href"])])):y("",!0)])]),_:1})]),C.value?(d(),c("div",lt,[e("div",at,[e("div",nt,[e("div",rt,[e("div",it,[r(l(O),{class:"w-6 h-6 text-red-600"})]),t[17]||(t[17]=e("div",{class:"ml-3"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Delete Asset ")],-1))]),e("div",dt,[e("p",ct,[t[18]||(t[18]=h(" Are you sure you want to delete ")),e("strong",null,i((u=_.value)==null?void 0:u.name),1),t[19]||(t[19]=h("? This action cannot be undone. "))])]),e("div",ut,[e("button",{onClick:X,disabled:l(a).processing,class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},i(l(a).processing?"Deleting...":"Delete"),9,mt),e("button",{onClick:ee,class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])])])])):y("",!0)]}),_:1}),$.value?(d(),c("div",pt,[e("div",ft,[e("div",vt,[e("div",gt,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Manage Allocations",-1)),e("p",bt,[t[20]||(t[20]=h("Asset: ")),e("strong",null,i((n=D.value)==null?void 0:n.name),1)])]),e("div",yt,[e("div",xt,[t[22]||(t[22]=h(" Total: ")),e("strong",{class:ue(M.value>100?"text-red-600":"text-gray-900")},i(M.value)+"%",3),t[23]||(t[23]=e("span",{class:"ml-2"},"(Partial allocations allowed. Do not exceed 100%.)",-1))]),e("button",{onClick:se,type:"button",class:"bg-purple-50 hover:bg-purple-100 text-purple-700 font-semibold py-2 px-3 rounded-lg transition-colors duration-200"}," + Add Row ")]),j.value?(d(),c("div",ht,"Loading current allocations...")):y("",!0),e("div",_t,[(d(!0),c(S,null,F(g.value,(u,o)=>(d(),c("div",{key:o,class:"grid md:grid-cols-6 gap-2 items-end"},[e("div",wt,[r(L,{modelValue:u.beneficiary_id,"onUpdate:modelValue":m=>u.beneficiary_id=m,label:"Beneficiary",options:P.value,error:""},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",At,[r(V,{modelValue:u.percentage,"onUpdate:modelValue":m=>u.percentage=m,type:"number",step:"0.01",min:"0",max:"100",label:"%"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",kt,[e("button",{onClick:m=>oe(o),type:"button",class:"text-red-600 hover:text-red-700 text-sm"},"Remove",8,Vt)])]))),128))]),e("div",Ct,[e("button",{onClick:ae,disabled:j.value,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Save Allocations ",8,$t),e("button",{onClick:t[8]||(t[8]=u=>$.value=!1),class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"}," Cancel ")])])])])):y("",!0)],64)}}};export{It as default};
