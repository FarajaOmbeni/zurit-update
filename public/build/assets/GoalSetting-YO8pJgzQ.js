import{r as h,n as B,p as U,C as K,b as m,o as u,c as V,f as D,a as t,u as l,q as i,t as g,z as C,d as _,h as $,Q as A,V as R,g as S,v as f,F as T,X as J,m as W,w as q,s as P}from"./app-B-GejVOE.js";import{A as Z}from"./AuthenticatedLayout-CimAnSyk.js";import{_ as tt}from"./Sidebar-D7o-5Ly5.js";import{f as et}from"./useDateFormat-pjOuPPEs.js";import{u as X,_ as H}from"./useAlert-bGlfQnuD.js";import{P as st,T as ot,X as Y}from"./x-Y8JTjXXK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const lt={class:"bg-white shadow rounded-lg p-4 border-2 border-purple-500"},at={class:"flex justify-between items-center border-b pb-2 mb-2"},rt={class:"text-lg font-semibold text-purple-700"},nt={class:"flex items-center space-x-2"},dt={class:"mt-1"},ut={class:"mt-1"},it={class:"mt-1"},pt={class:"mt-1"},gt={class:"w-full bg-gray-200 rounded-full h-2.5 mt-2"},mt={class:"flex justify-between items-center mb-2"},ct={class:"grid grid-cols-2 gap-x-2 gap-y-2"},ft={class:"col-span-2"},xt={class:"col-span-2"},vt={class:"col-span-1"},bt={class:"col-span-1"},yt={class:"col-span-2"},wt={class:"mt-3 flex justify-end space-x-2"},_t=["disabled"],kt={class:"flex justify-between items-center mb-4"},ht={class:"flex justify-end space-x-3"},Ct={class:"px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},I={__name:"GoalCard",props:{goal:Object},emits:["update","delete"],setup(E,{emit:w}){const{alertState:b,openAlert:k,clearAlert:G}=X(),y=E,M=w,o=h({...y.goal});B(()=>y.goal,n=>{o.value={...n}},{deep:!0});const F=U(()=>o.value.target_amount===0?0:Math.min(100,o.value.current_amount/o.value.target_amount*100)),x=n=>"KES "+Math.round(n).toLocaleString(),v=h(!1),a=K({name:"",description:"",target_amount:"",start_date:"",target_date:""}),L=()=>{a.name=o.value.name,a.description=o.value.description,a.target_amount=o.value.target_amount,a.start_date=new Date(o.value.start_date).toISOString().split("T")[0]||"",a.target_date=new Date(o.value.target_date).toISOString().split("T")[0]||""},N=()=>{v.value=!1};B(v,n=>{n&&L()});const j=()=>{a.put(route("goal.update",o.value.id),{preserveScroll:!0,onSuccess:n=>{var e;(e=n==null?void 0:n.props)!=null&&e.goal?o.value=n.props.goal:o.value={...o.value,name:a.name,description:a.description,target_amount:a.target_amount,start_date:a.start_date,target_date:a.target_date},v.value=!1,k("success","Goal Updated Successfully."),M("update",o.value)},onError:n=>{const e=Object.values(n).flat().join(" ");k("danger",e,5e3)}})},c=h(!1),p=()=>{c.value=!1},s=h(!1),r=()=>{s.value=!0,J.post(route("goal.destroy",o.value.id)).then(()=>{c.value=!1,k("success","Goal deleted successfully."),M("delete",o.value.id)}).catch(n=>{s.value=!1,k("danger","Failed to delete goal. Please try again.",5e3),console.error("Error deleting goal:",n)})},z=U(()=>{const n=new Date(o.value.start_date),e=new Date(o.value.target_date),d=e.getFullYear()-n.getFullYear(),Q=e.getMonth()-n.getMonth(),O=d*12+Q;return O<=0?0:o.value.target_amount/O});return(n,e)=>(u(),m(T,null,[l(b)?(u(),V(H,{key:0,type:l(b).type,message:l(b).message,duration:l(b).duration,"auto-close":l(b).autoClose,onClose:l(G)},null,8,["type","message","duration","auto-close","onClose"])):D("",!0),t("div",lt,[t("div",at,[t("h3",rt,g(o.value.name),1),t("div",nt,[t("span",{class:C(["px-2 py-1 text-xs font-bold uppercase rounded-full",{"bg-yellow-400 text-black":o.value.status==="in_progress","bg-green-500 text-white":o.value.status==="achieved","bg-gray-400 text-black":o.value.status==="abandoned"}])},g(o.value.status),3),t("button",{onClick:e[0]||(e[0]=d=>v.value=!0),class:C(["p-1 text-purple-600 hover:text-purple-800 transition-colors",{hidden:o.value.status==="achieved"}])},[_(l(st),{class:"h-4 w-4"})],2),t("button",{onClick:e[1]||(e[1]=d=>c.value=!0),class:C(["p-1 text-red-600 hover:text-red-800 transition-colors",{hidden:o.value.status==="achieved"}])},[_(l(ot),{class:"h-4 w-4"})],2)])]),t("div",{class:C(["mb-2",o.value.status==="in_progress"?"text-gray-600":"text-green-500"])},[t("p",null,g(o.value.description),1),t("p",dt,[e[13]||(e[13]=t("strong",null,"Goal:",-1)),$(" "+g(x(o.value.target_amount)),1)]),t("p",ut,[e[14]||(e[14]=t("strong",null,"Saved:",-1)),$(" "+g(x(o.value.current_amount)),1)]),i(t("p",it,[e[15]||(e[15]=t("strong",null,"Remaining:",-1)),$(" "+g(x(o.value.target_amount-o.value.current_amount)),1)],512),[[A,o.value.status==="in_progress"]]),i(t("p",pt,[e[16]||(e[16]=t("strong",null,"Minimum Contribution:",-1)),$(" "+g(x(z.value)),1)],512),[[A,o.value.status==="in_progress"]]),t("div",gt,[t("div",{class:C([o.value.status==="in_progress"?"bg-yellow-400":"bg-green-500","h-2.5 rounded-full"]),style:R({width:F.value+"%"})},null,6)])],2),i(t("div",{class:"text-right text-sm text-gray-500"}," Target Date: "+g(l(et)(o.value.target_date)),513),[[A,o.value.status==="in_progress"]]),v.value?(u(),m("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:N},[t("div",{class:"bg-white rounded-lg p-3 w-full max-w-sm mx-4",onClick:e[9]||(e[9]=S(()=>{},["stop"]))},[t("div",mt,[e[17]||(e[17]=t("h3",{class:"text-base font-medium text-purple-700"},"Edit Goal",-1)),t("button",{onClick:e[2]||(e[2]=d=>v.value=!1),class:"text-gray-500 hover:text-gray-700"},[_(l(Y),{class:"h-4 w-4"})])]),t("form",{onSubmit:S(j,["prevent"])},[t("div",ct,[t("div",ft,[e[18]||(e[18]=t("label",{for:"name",class:"block text-xs font-medium text-gray-700"},"Name",-1)),i(t("input",{type:"text",id:"name","onUpdate:modelValue":e[3]||(e[3]=d=>l(a).name=d),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[f,l(a).name]])]),t("div",xt,[e[19]||(e[19]=t("label",{for:"target_amount",class:"block text-xs font-medium text-gray-700"},"Target Amount",-1)),i(t("input",{type:"number",id:"target_amount","onUpdate:modelValue":e[4]||(e[4]=d=>l(a).target_amount=d),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[f,l(a).target_amount]])]),t("div",vt,[e[20]||(e[20]=t("label",{for:"start_date",class:"block text-xs font-medium text-gray-700"},"Start Date",-1)),i(t("input",{type:"date",id:"start_date","onUpdate:modelValue":e[5]||(e[5]=d=>l(a).start_date=d),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[f,l(a).start_date]])]),t("div",bt,[e[21]||(e[21]=t("label",{for:"target_date",class:"block text-xs font-medium text-gray-700"},"Target Date",-1)),i(t("input",{type:"date",id:"target_date","onUpdate:modelValue":e[6]||(e[6]=d=>l(a).target_date=d),class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[f,l(a).target_date]])]),t("div",yt,[e[22]||(e[22]=t("label",{for:"description",class:"block text-xs font-medium text-gray-700"},"Description",-1)),i(t("textarea",{id:"description","onUpdate:modelValue":e[7]||(e[7]=d=>l(a).description=d),rows:"2",class:"mt-0.5 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 text-xs py-1.5 px-2"},null,512),[[f,l(a).description]])])]),t("div",wt,[t("button",{type:"button",onClick:e[8]||(e[8]=d=>v.value=!1),class:"px-2 py-1 border border-gray-300 rounded-md shadow-sm text-xs font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),t("button",{type:"submit",disabled:l(a).processing,class:"px-2 py-1 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-1 focus:ring-purple-500"},g(l(a).processing?"Saving...":"Save Changes"),9,_t)])],32)])])):D("",!0),c.value?(u(),m("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:p},[t("div",{class:"bg-white rounded-lg p-5 w-full max-w-sm mx-4",onClick:e[12]||(e[12]=S(()=>{},["stop"]))},[t("div",kt,[e[23]||(e[23]=t("h3",{class:"text-lg font-semibold text-red-600"},"Delete Goal",-1)),t("button",{onClick:e[10]||(e[10]=d=>c.value=!1),class:"text-gray-500 hover:text-gray-700"},[_(l(Y),{class:"h-5 w-5"})])]),e[24]||(e[24]=t("p",{class:"text-gray-700 mb-4"},"Are you sure you want to delete this goal? This action cannot be undone. ",-1)),t("div",ht,[t("button",{onClick:e[11]||(e[11]=d=>c.value=!1),class:"px-3 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),t("form",{onSubmit:S(r,["prevent"])},[t("button",Ct,g(s.value?"Deleting...":"Delete"),1)],32)])])])):D("",!0)])],64))}},$t={class:"w-full text-gray-900"},St={class:"container mx-auto p-4"},Dt={class:"container mx-auto p-4"},Gt={class:"mb-8"},Mt={key:0,class:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},jt={key:1,class:"text-gray-600"},Vt={key:0,class:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},At={key:1,class:"text-gray-600"},Tt={class:"bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 overflow-hidden"},Ut={class:"grid grid-cols-2 gap-x-2 gap-y-2"},Et={class:"col-span-2"},Ft={class:"col-span-2"},Lt={class:"relative"},Nt={class:"col-span-1"},zt={class:"col-span-1"},Ot={class:"col-span-2"},Bt={class:"flex justify-end space-x-2 mt-3"},qt={type:"submit",class:"px-2 py-1 text-xs bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-1 focus:ring-purple-500"},Rt={__name:"GoalSetting",props:{goals:Array},setup(E){const{alertState:w,openAlert:b,clearAlert:k}=X(),G=E,y=h([...G.goals]),M=p=>{y.value=y.value.filter(s=>s.id!==p)},o=h(!1),F=()=>{o.value=!0},x=()=>{o.value=!1,L()},v=p=>{p.target.classList.contains("modal-overlay")&&x()},a=K({name:"",description:"",target_amount:"",start_date:"",target_date:""}),L=()=>{a.reset()},N=()=>{a.post(route("goal.store"),{onSuccess:p=>{a.reset(),x(),b("success","Goal added successfully",5e3),window.location.reload()},onError:p=>{const s=Object.values(p).flat().join(" ");b("danger",s,5e3)}})},j=U(()=>y.value.filter(p=>p.status!=="achieved")),c=U(()=>y.value.filter(p=>p.status==="achieved"));return(p,s)=>(u(),m(T,null,[_(l(W),{title:"Goal Setting"}),_(Z,null,{default:q(()=>[t("div",$t,[_(tt,null,{default:q(()=>[t("div",St,[t("div",{class:"flex justify-between items-center mb-6"},[s[7]||(s[7]=t("h1",{class:"text-2xl font-bold text-purple-700"},"Your Goals",-1)),t("button",{onClick:F,class:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center transition-colors duration-200"},s[6]||(s[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),$(" Add Goal ")]))]),t("div",Dt,[l(w)?(u(),V(H,{key:0,type:l(w).type,message:l(w).message,duration:l(w).duration,"auto-close":l(w).autoClose,onClose:l(k)},null,8,["type","message","duration","auto-close","onClose"])):D("",!0),t("section",Gt,[s[8]||(s[8]=t("h2",{class:"text-xl font-semibold text-purple-700 mb-4"},"Active Goals",-1)),j.value.length?(u(),m("div",Mt,[(u(!0),m(T,null,P(j.value,r=>(u(),V(I,{key:r.id||r.goal_id,goal:r,onUpdate:s[0]||(s[0]=z=>y.value.value=[...G.goals]),onDelete:M},null,8,["goal"]))),128))])):(u(),m("div",jt," No active goals found. "))]),i(t("section",null,[s[9]||(s[9]=t("h2",{class:"text-xl font-semibold text-purple-700 mb-4"},"Completed Goals",-1)),c.value.length?(u(),m("div",Vt,[(u(!0),m(T,null,P(c.value,r=>(u(),V(I,{key:r.id||r.goal_id,goal:r},null,8,["goal"]))),128))])):(u(),m("div",At," No completed goals found. "))],512),[[A,c.value.length>0]])])])]),_:1})]),o.value?(u(),m("div",{key:0,onClick:v,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay"},[t("div",Tt,[t("div",{class:"bg-purple-600 text-white px-3 py-2 flex justify-between items-center"},[s[11]||(s[11]=t("h3",{class:"text-base font-medium"},"Add New Goal",-1)),t("button",{onClick:x,class:"text-white hover:text-gray-200 focus:outline-none"},s[10]||(s[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),t("form",{onSubmit:S(N,["prevent"]),class:"p-3"},[t("div",Ut,[t("div",Et,[s[12]||(s[12]=t("label",{for:"name",class:"block text-gray-700 text-xs font-medium mb-1"},"Name",-1)),i(t("input",{type:"text",id:"name","onUpdate:modelValue":s[1]||(s[1]=r=>l(a).name=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[f,l(a).name]])]),t("div",Ft,[s[14]||(s[14]=t("label",{for:"target_amount",class:"block text-gray-700 text-xs font-medium mb-1"},"Target Amount",-1)),t("div",Lt,[s[13]||(s[13]=t("div",{class:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 text-xs"},"KES")],-1)),i(t("input",{type:"number",id:"target_amount","onUpdate:modelValue":s[2]||(s[2]=r=>l(a).target_amount=r),class:"w-full pl-8 pr-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",step:"0.01",min:"0",required:""},null,512),[[f,l(a).target_amount]])])]),t("div",Nt,[s[15]||(s[15]=t("label",{for:"start_date",class:"block text-gray-700 text-xs font-medium mb-1"},"Start Date",-1)),i(t("input",{type:"date",id:"start_date","onUpdate:modelValue":s[3]||(s[3]=r=>l(a).start_date=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[f,l(a).start_date]])]),t("div",zt,[s[16]||(s[16]=t("label",{for:"target_date",class:"block text-gray-700 text-xs font-medium mb-1"},"Target Date",-1)),i(t("input",{type:"date",id:"target_date","onUpdate:modelValue":s[4]||(s[4]=r=>l(a).target_date=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",required:""},null,512),[[f,l(a).target_date]])]),t("div",Ot,[s[17]||(s[17]=t("label",{for:"description",class:"block text-gray-700 text-xs font-medium mb-1"},"Description",-1)),i(t("textarea",{id:"description","onUpdate:modelValue":s[5]||(s[5]=r=>l(a).description=r),class:"w-full px-2 py-1.5 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-purple-500",rows:"2"},null,512),[[f,l(a).description]])])]),t("div",Bt,[t("button",{type:"button",onClick:x,class:"px-2 py-1 text-xs border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-purple-500"}," Cancel "),t("button",qt,g(l(a).processing?"Saving...":"Add Goal"),1)])],32)])])):D("",!0)]),_:1})],64))}};export{Rt as default};
