import{A as _}from"./AuthenticatedLayout-ChCsD__Y.js";import{r as u,y as P,B as S,b as r,o,d as f,u as j,m as C,w as h,a as e,f as m,n as x,t as g,F as B,X as M}from"./app-C9eKbMCQ.js";import{_ as I}from"./Sidebar-CHXG9LDV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                */import"./EllipsisHorizontalIcon-CtVy5scB.js";import"./AcademicCapIcon-DqCd3Kot.js";import"./UserIcon-BhEDiHjm.js";import"./HomeIcon-evOUFcCl.js";const N={class:"w-full text-gray-900"},A={class:"min-h-screen bg-white p-6"},F={class:"max-w-2xl mx-auto"},L={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-6 mb-6"},T={class:"flex items-center justify-center mb-4"},z={key:0,class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},E={key:1,class:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-full"},$={key:2,class:"flex items-center justify-center w-12 h-12 bg-red-100 rounded-full"},R={class:"font-medium"},V={class:"bg-gray-50 rounded-lg p-4 mb-6"},Z={class:"space-y-2 text-sm"},q={class:"flex justify-between"},D={class:"font-medium"},K={class:"flex justify-between"},U={class:"font-medium"},Y={class:"flex justify-between"},G={class:"flex justify-center space-x-4"},O={key:0,class:"mt-6 text-center text-sm text-gray-500"},ne={__name:"ZuriScoreProcessing",props:{payment:{type:Object,required:!0},phone:{type:String,required:!0}},setup(p){const d=p,s=u(d.payment.status),v=u(d.payment.reason),i=u(!0),l=u(""),n=u("info");let c=null;const w=async()=>{try{const a=await M.get(`/user/zuriscore/status/${d.payment.id}`);s.value=a.data.status,v.value=a.data.reason,b(),(s.value==="succeeded"||s.value==="failed")&&(clearInterval(c),i.value=!1)}catch(a){console.error("Error checking payment status:",a),l.value="Error checking payment status. Please refresh the page.",n.value="danger",i.value=!1}},b=()=>{switch(s.value){case"pending":l.value=`STK push sent to ${d.phone}. Please check your phone and enter your M-Pesa PIN to complete the payment.`,n.value="info";break;case"succeeded":l.value="Payment successful! Your ZuriScore report has been generated. Please check your email, including the spam folder, and mark it as not spam if necessary.",n.value="success";break;case"failed":l.value=k(v.value),n.value="danger";break;default:l.value="Processing payment...",n.value="info"}},k=a=>{const t=(a==null?void 0:a.toLowerCase())||"";return t.includes("cancel")||t.includes("cancelled")?"Payment was cancelled. You can try again by going back to the form.":t.includes("pin")||t.includes("wrong")?"Payment failed due to incorrect PIN. Please try again.":t.includes("insufficient")?"Payment failed due to insufficient funds. Please ensure you have enough balance and try again.":t.includes("timeout")?"Payment timed out. Please try again after 2 minutes.":`Payment failed: ${a||"Unknown error"}. Please try again.`},y=()=>{window.location.href="/user/zuriscore"};return P(()=>{b(),s.value==="pending"?c=setInterval(w,3e3):i.value=!1}),S(()=>{c&&clearInterval(c)}),(a,t)=>(o(),r(B,null,[f(j(C),{title:"Payment Processing"}),f(_,null,{default:h(()=>[e("div",N,[f(I,null,{default:h(()=>[e("div",A,[e("div",F,[t[7]||(t[7]=e("h1",{class:"text-2xl font-semibold text-gray-900 mb-6"},"ZuriScore Payment Processing",-1)),e("div",L,[e("div",T,[i.value?(o(),r("div",z)):s.value==="succeeded"?(o(),r("div",E,t[0]||(t[0]=[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):s.value==="failed"?(o(),r("div",$,t[1]||(t[1]=[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):m("",!0)]),e("div",{class:x([{"text-blue-700 bg-blue-50 border-blue-200":n.value==="info","text-green-700 bg-green-50 border-green-200":n.value==="success","text-red-700 bg-red-50 border-red-200":n.value==="danger","text-yellow-700 bg-yellow-50 border-yellow-200":n.value==="warning"},"p-4 rounded-lg border text-center"])},[e("p",R,g(l.value),1)],2)]),e("div",V,[t[5]||(t[5]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Payment Details",-1)),e("div",Z,[e("div",q,[t[2]||(t[2]=e("span",{class:"text-gray-600"},"Phone Number:",-1)),e("span",D,g(p.phone),1)]),e("div",K,[t[3]||(t[3]=e("span",{class:"text-gray-600"},"Amount:",-1)),e("span",U,"KES "+g(p.payment.amount),1)]),e("div",Y,[t[4]||(t[4]=e("span",{class:"text-gray-600"},"Status:",-1)),e("span",{class:x(["font-medium capitalize",{"text-blue-600":s.value==="pending","text-green-600":s.value==="succeeded","text-red-600":s.value==="failed"}])},g(s.value),3)])])]),e("div",G,[s.value==="failed"?(o(),r("button",{key:0,onClick:y,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200"}," Try Again ")):m("",!0),s.value==="succeeded"?(o(),r("button",{key:1,onClick:y,class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200"}," Generate Another Report ")):m("",!0),e("button",{onClick:y,class:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200"}," Back to Form ")]),i.value?(o(),r("div",O,t[6]||(t[6]=[e("p",null,"This page will automatically update when payment is processed.",-1)]))):m("",!0)])])]),_:1})])]),_:1})],64))}};export{ne as default};
