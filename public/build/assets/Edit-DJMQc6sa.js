import{C as w,c as C,o as l,w as M,a as t,g as V,b as n,f as a,j as f,u as o,v as b,t as p,F as g,i as x,k as $,h as y,W as S}from"./app-C5BuU8Tk.js";import{_ as B}from"./AdminSidebar-BuClw-Mc.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./EllipsisHorizontalIcon-oSHXUfoM.js";import"./UserIcon-BCwEcoPB.js";import"./CalendarDaysIcon-CRurjYAK.js";const U={class:"max-w-3xl mx-auto py-10 sm:px-6 lg:px-8"},F={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},E={class:"p-6 bg-white border-b border-gray-200"},j={class:"mb-6"},A={key:0,class:"mt-2 text-sm text-red-600"},P={key:0,class:"mb-6"},T={key:0,class:"mt-2 text-sm text-red-600"},q={key:1,class:"mb-6"},z=["value","disabled"],N={key:0,class:"mt-2 text-sm text-red-600"},H={key:2,class:"mb-6"},L={class:"mb-4"},O=["for"],W=["onUpdate:modelValue","id"],I={class:"mb-2"},R=["for"],G=["onChange","id"],J={key:0,class:"mt-1 text-sm text-gray-600"},K=["onClick"],Q={class:"flex items-center justify-end pt-6 border-t border-gray-200"},X=["disabled"],Y={key:0},Z={key:1},ee={__name:"Edit",props:{course:Object,mainCourses:{type:Array,default:()=>[]}},setup(u){const i=u,s=w({title:i.course.title,description:i.course.parent_id&&i.course.description||"",parent_id:i.course.parent_id&&i.course.parent_id||"",materials:i.course.parent_id&&i.course.materials&&i.course.materials.length>0?i.course.materials.map(d=>({id:d.id,title:d.title,file:null,existing_file:d.file_name})):i.course.parent_id?[{title:"",file:null,existing_file:null}]:[]}),_=()=>{i.course.parent_id&&s.materials.push({title:"",file:null,existing_file:null})},v=d=>{i.course.parent_id&&s.materials.splice(d,1)},h=(d,e)=>{const r=d.target.files[0];r&&r.type==="application/pdf"?s.materials[e].file=r:(alert("Please upload a valid PDF file."),d.target.value="")},k=()=>{if(!i.course.parent_id)s.put(route("admin.courses.update",{course:i.course.id}),{preserveScroll:!0,onSuccess:()=>s.reset()});else{const d={title:s.title,description:s.description,parent_id:s.parent_id,materials:s.materials.map(e=>{const r={title:e.title,existing_file:e.existing_file};return e.id&&(r.id=e.id),e.file&&(r.file=e.file),r})};S.put(route("admin.subcourses.update",{subcourse:i.course.id}),d,{preserveScroll:!0})}};return(d,e)=>(l(),C(B,{title:`Edit ${u.course.title}`},{default:M(()=>[t("div",U,[t("div",F,[t("div",E,[e[13]||(e[13]=t("h2",{class:"text-lg font-medium text-gray-900 mb-6"},"Edit Course",-1)),t("form",{onSubmit:V(k,["prevent"])},[t("div",j,[e[4]||(e[4]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).title=r),type:"text",id:"title",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm",required:""},null,512),[[b,o(s).title]]),o(s).errors.title?(l(),n("p",A,p(o(s).errors.title),1)):a("",!0)]),u.course.parent_id?(l(),n("div",P,[e[5]||(e[5]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),f(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).description=r),id:"description",rows:"4",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm",required:""},null,512),[[b,o(s).description]]),o(s).errors.description?(l(),n("p",T,p(o(s).errors.description),1)):a("",!0)])):a("",!0),u.course.parent_id?(l(),n("div",q,[e[7]||(e[7]=t("label",{for:"parent_id",class:"block text_sm font-medium text-gray-700"},"Parent Course (Optional)",-1)),f(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(s).parent_id=r),id:"parent_id",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm"},[e[6]||(e[6]=t("option",{value:""},"Select a main course (or leave empty to make this a main course)",-1)),(l(!0),n(g,null,x(u.mainCourses,r=>(l(),n("option",{key:r.id,value:r.id,disabled:r.id===u.course.id},p(r.title),9,z))),128))],512),[[$,o(s).parent_id]]),e[8]||(e[8]=t("p",{class:"mt-1 text-xs text-gray-500"}," Leave empty to make this a main course, or select a main course to make this a sub-course. ",-1)),o(s).errors.parent_id?(l(),n("p",N,p(o(s).errors.parent_id),1)):a("",!0)])):a("",!0),u.course.parent_id?(l(),n("div",H,[e[11]||(e[11]=t("h3",{class:"text-md font-medium text-gray-700 mb-4"},"Study Materials",-1)),(l(!0),n(g,null,x(o(s).materials,(r,m)=>(l(),n("div",{key:m,class:"material-item mb-4 p-4 border rounded-lg"},[t("div",L,[t("label",{for:`material-title-${m}`,class:"block text-sm font-medium text-gray-700 mb-1"},"Document Title",8,O),f(t("input",{"onUpdate:modelValue":c=>r.title=c,type:"text",id:`material-title-${m}`,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm",required:""},null,8,W),[[b,r.title]])]),t("div",I,[t("label",{for:`material-file-${m}`,class:"block text-sm font-medium text-gray-700 mb-1"},"File (PDF)",8,R),t("input",{type:"file",onChange:c=>h(c,m),id:`material-file-${m}`,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100",accept:".pdf"},null,40,G),r.existing_file?(l(),n("p",J," Current file: "+p(r.existing_file),1)):a("",!0),e[9]||(e[9]=t("p",{class:"mt-1 text-xs text-gray-500"},"Maximum file size: 10MB",-1))]),o(s).materials.length>1?(l(),n("button",{key:0,type:"button",onClick:c=>v(m),class:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Remove Material ",8,K)):a("",!0)]))),128)),t("button",{type:"button",onClick:_,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-purple-700 bg-purple-100 hover:bg-purple-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"},e[10]||(e[10]=[t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),y(" Add Another Material ")]))])):a("",!0),t("div",Q,[t("button",{type:"button",onClick:e[3]||(e[3]=r=>d.$inertia.visit(d.route("admin.courses.index"))),class:"mr-4 inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"}," Cancel "),t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",disabled:o(s).processing},[o(s).processing?(l(),n("span",Y,e[12]||(e[12]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),y(" Updating... ")]))):(l(),n("span",Z,"Update Course"))],8,X)])],32)])])])]),_:1},8,["title"]))}},ne=D(ee,[["__scopeId","data-v-db0146ef"]]);export{ne as default};
